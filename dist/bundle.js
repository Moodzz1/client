try{var Type,ManagerType,ws,Levels,find$2=t=>Object.values(modules).find(r=>r?.publicModule.exports?.[t])?.publicModule?.exports;window.ReactNative=find$2("AppState"),window.React=find$2("createElement");try{Promise.resolve().then(function(){return index$1}).then(t=>t.initialize())}catch(e){alert("Enmity failed to initialize: "+e.message)}}catch(e){alert("Enmity failed to initialize: "+e.message)}function findInTree(t={},r=t=>t,{ignore:n=[],walkable:l=[],maxProperties:u=100}={}){for(var f=[t],d=function(...t){try{return Reflect.apply(r,this,t)}catch{return!1}};f.length&&u;){var h=f.shift();if(d(h))return h;if(Array.isArray(h))f.push(...h);else if("object"==typeof h&&null!==h){if(l.length)for(var g in h){var y=h[g];~l.indexOf(g)&&!~n.indexOf(g)&&f.push(y)}else for(var $ in h){var E=h[$];h&&~n.indexOf($)||f.push(E)}}u--}}function findInReactTree(t,r=t=>t,n={}){return findInTree(t,r,{walkable:["props","children"],...n})}var overrides={useMemo:t=>t(),useState:t=>[t,()=>void 0],useReducer:t=>[t,()=>void 0],useEffect:()=>{},useLayoutEffect:()=>{},useRef:()=>({current:null}),useCallback:t=>t,useImperativeHandle:()=>{},useContext:t=>t._currentValue},keys=Object.keys(overrides);function forceRender(t){return(...r)=>{var n=window.React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher.current,l=keys.map(t=>[t,n[t]]);Object.assign(n,overrides);var u={rendered:null,error:null};try{u.rendered=t(...r)}catch(t){u.error=t}if(Object.assign(n,Object.fromEntries(l)),u.error)throw u.error;return u.rendered}}function capitalize(t){if("string"!=typeof t)throw TypeError("capitalize's first argument must be of type string");return t.charAt(0).toUpperCase()+t.slice(1)}function debounce(t,r){var n;return function(...l){clearTimeout(n),n=setTimeout(()=>t.apply(this,l),r)}}var Colors={red:"\x1b[31m",reset:"\x1b[0m",green:"\x1b[32m",gray:"\x1b[90m",blue:"\x1b[34m",yellow:"\x1b[33m"};function colorize(t,r="reset"){return Colors[r.toLowerCase()]+t+Colors.reset}function attempt(t){try{t()}catch{}}function isEmpty(t){for(var r in t)return!1;return!0}function noop(...t){}function uuid(t=30){var r="";do{var n=16*Math.random()|0;r+=(12==r.length?4:16==r.length?3&n|8:n).toString(16)}while(r.length<t);return r}!function(t){t.Before="before",t.Instead="instead",t.After="after"}(Type||(Type={}));var patches=[];function before(t,r,n,l,u=!1){return patch(t,r,n,l,Type.Before,u)}function instead(t,r,n,l,u=!1){return patch(t,r,n,l,Type.Instead,u)}function after(t,r,n,l,u=!1){return patch(t,r,n,l,Type.After,u)}function createPatcher(t){return{getPatchesByCaller,before:(r,n,l,u=!1)=>before(t,r,n,l,u),instead:(r,n,l,u=!1)=>instead(t,r,n,l,u),after:(r,n,l,u=!1)=>after(t,r,n,l,u),unpatchAll:()=>unpatchAll(t)}}function getPatchesByCaller(t){if(!t)return[];var r=[];for(var n of patches)for(var l of[...n.patches.before,...n.patches.instead,...n.patches.after])t&&l.caller!==t||r.push(l);return r}function unpatchAll(t){var r=getPatchesByCaller(t);if(r.length)for(var n of r)n.unpatch()}function override(t){return function(){if(!t?.patches?.before.length&&!t?.patches?.after.length&&!t?.patches?.instead.length&&!patches.find(r=>r.mdl===t.mdl&&r.func===t.func))return t.unpatch(),new.target?new t.original(...arguments):t.original.apply(this,arguments);for(var r,n=arguments,l=[...t.patches.before],u=0;u<l.length;u++){var f=l[u];if(f)try{var d=f.callback(this,n,t.original.bind(this));Array.isArray(d)&&(n=d),f.once&&f.unpatch()}catch(r){console.error(`Could not fire before patch for ${t.func} of ${f.caller}`,r)}}var h=[...t.patches.instead];if(h.length)for(var g=0;g<h.length;g++){var y=h[g];if(y)try{var $=y.callback(this,n,t.original.bind(this));void 0!==$&&(r=$),y.once&&y.unpatch()}catch(r){console.error(`Could not fire instead patch for ${t.func} of ${y.caller}`,r)}}else r=new.target?new t.original(...n):t.original.apply(this,n);for(var E=[...t.patches.after],T=0;T<E.length;T++){var R=E[T];if(R)try{var S=R.callback(this,n,r,t=>r=t);void 0!==S&&(r=S),R.once&&R.unpatch()}catch(r){console.error(`Could not fire after patch for ${t.func} of ${R.caller}`,r)}}return r}}function push(t,r){"renderPatched"===r&&(t[r]=function(...r){return new.target?new t(...r):t.apply(this,r)});var n={mdl:t,func:r,original:t[r],unpatch:()=>{"renderPatched"===n.func?delete n.mdl.renderPatched:n.mdl[n.func]=n.original,n.patches={before:[],after:[],instead:[]}},patches:{before:[],after:[],instead:[]}},l=override(n);t[r]=l;var u=Object.getOwnPropertyDescriptors(n.original);return delete u.length,Object.defineProperties(t[r],{...u,toString:{value:()=>n.original.toString(),configurable:!0,enumerable:!1},__original:{value:n.original,configurable:!0,enumerable:!1}}),patches.push(n),n}function get$1(t,r){return patches.find(n=>n.mdl===t&&n.func===r)||push(t,r)}function patch(t,r,n,l,u=Type.After,f=!1){if(t&&"string"==typeof t){if(r&&["function","object"].includes(typeof r)){if(n&&"string"==typeof n){if(l&&"function"==typeof l){if(!u||"string"!=typeof u||!["after","before","instead"].includes(u))throw TypeError('fifth argument "type" must be of type string and any of the three: after, before, instead')}else throw TypeError('fourth argument "callback" must be of type function')}else throw TypeError('third argument "func" must be of type string')}else throw TypeError('second argument "mdl" must be of type function or object')}else throw TypeError('first argument "caller" must be of type string');var d=get$1(r,n),h={caller:t,once:f,type:u,id:d.patches?.[u]?.length??0,callback:l,unpatch:()=>{var t=d.patches?.[u].findIndex(t=>t.id===h.id);if(~t&&d.patches?.[u].splice(t,1),!d.patches?.before.length&&!d.patches?.after.length&&!d.patches?.instead.length){var l=patches.findIndex(t=>t.mdl==r&&t.func==n);l&&(patches[l]?.unpatch(),patches.splice(l,1))}}};return d.patches[u]??=[],d.patches[u].push(h),h.unpatch}var Patcher$3={createPatcher,before,instead,after,unpatchAll,patches},patcher=Object.freeze({__proto__:null,get Type(){return Type},after:after,before:before,createPatcher:createPatcher,default:Patcher$3,getPatchesByCaller:getPatchesByCaller,instead:instead,patches:patches,unpatchAll:unpatchAll});function _check_private_redeclaration(t,r){if(r.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function _class_apply_descriptor_get(t,r){return r.get?r.get.call(t):r.value}function _class_call_check$7(t,r){if(!(t instanceof r))throw TypeError("Cannot call a class as a function")}function _class_extract_field_descriptor(t,r,n){if(!r.has(t))throw TypeError("attempted to "+n+" private field on non-instance");return r.get(t)}function _class_private_field_get(t,r){var n=_class_extract_field_descriptor(t,r,"get");return _class_apply_descriptor_get(t,n)}function _class_private_field_init(t,r,n){_check_private_redeclaration(t,r),r.set(t,n)}function _defineProperties$7(t,r){for(var n=0;n<r.length;n++){var l=r[n];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function _create_class$7(t,r,n){return r&&_defineProperties$7(t.prototype,r),n&&_defineProperties$7(t,n),t}var _listeners=new WeakMap,EventEmitter=function(){function t(){_class_call_check$7(this,t),_class_private_field_init(this,_listeners,{writable:!0,value:{}})}return _create_class$7(t,[{key:"emit",value:function(t,r=null){if(_class_private_field_get(this,_listeners)[t])for(var n of _class_private_field_get(this,_listeners)[t])try{n(r)}catch(r){console.error(`Failed to fire event listener for ${t}:`,r.message)}}},{key:"on",value:function(t,r){this.addListener(t,r)}},{key:"off",value:function(t,r){this.removeListener(t,r)}},{key:"addListener",value:function(t,r){_class_private_field_get(this,_listeners)[t]??=new Set,_class_private_field_get(this,_listeners)[t].add(r)}},{key:"removeListener",value:function(t,r){_class_private_field_get(this,_listeners)[t]&&(_class_private_field_get(this,_listeners)[t].delete(r),_class_private_field_get(this,_listeners)[t].size||delete _class_private_field_get(this,_listeners)[t])}}]),t}(),{DCDFileManager:DCDFileManager$1}=ReactNative.NativeModules,Events=new EventEmitter,settings$2=globalThis.ENMITY_SETTINGS??{},on=Events.on.bind(Events),off=Events.off.bind(Events);function get(t,r,n){return settings$2[t]?.[r]??n}function set(t,r,n){settings$2[t]??={},settings$2[t][r]=n,Events.emit("changed",{store:t,key:r,value:n}),Events.emit("set",{store:t,key:r,value:n})}function toggle(t,r,n){settings$2[t]??={};var l=settings$2[t][r]??n;settings$2[t][r]=!l,Events.emit("changed",{store:t,key:r,value:!l}),Events.emit("toggled",{store:t,key:r,prev:l,value:!l})}function remove$4(t,r){delete settings$2[t][r],isEmpty(settings$2[t])&&delete settings$2[t],Events.emit("changed",{store:t,key:r,value:void 0}),Events.emit("removed",{store:t,key:r})}function getStore(t){return{set:(r,n)=>set(t,r,n),get:(r,n)=>get(t,r,n),toggle:(r,n)=>toggle(t,r,n),remove:r=>remove$4(t,r),useSettingsStore:()=>useSettingsStore(t)}}function useSettingsStore(t){var[,r]=React.useState({});return React.useEffect(()=>{function n(n){n.store===t&&r({})}return Events.on("changed",n),()=>void Events.off("changed",n)},[]),getStore(t)}Events.on("changed",debounce(()=>{var t=JSON.stringify(settings$2),r="Enmity/settings.json";DCDFileManager$1.writeFile("documents",r,t,"utf8")},250));var Storage={useSettingsStore,getStore,get,set,remove:remove$4,on,off},storage=Object.freeze({__proto__:null,default:Storage,get:get,getStore:getStore,off:off,on:on,remove:remove$4,set:set,settings:settings$2,toggle:toggle,useSettingsStore:useSettingsStore});function log(...t){return console.log("\xbb",...t)}function error(...t){return console.error("\xbb",...t)}function success(...t){return console.log("\xbb",...t)}function warn(...t){return console.warn("\xbb",...t)}function debug$1(...t){return console.debug("\xbb",...t)}function info(...t){return console.info("\xbb",...t)}function createLogger(...t){var r=t.join(" â†’ ")+":";return{log:(...t)=>log(r,...t),error:(...t)=>error(r,...t),success:(...t)=>success(r,...t),warn:(...t)=>warn(r,...t),debug:(...t)=>debug$1(r,...t),info:(...t)=>info(r,...t)}}var Invite="enmity",Links={GitHub:"https://github.com/enmity-mod",Twitter:"https://twitter.com/EnmityApp"},Screens={General:"ENMITY_GENERAL",Plugins:"ENMITY_PLUGINS",Themes:"ENMITY_THEMES",Updater:"ENMITY_UPDATER",Custom:"CUSTOM"},Regex={SemanticVersioning:/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/i,URL:/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/i};function _assert_this_initialized$6(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function asyncGeneratorStep$3(t,r,n,l,u,f,d){try{var h=t[f](d),g=h.value}catch(t){n(t);return}h.done?r(g):Promise.resolve(g).then(l,u)}function _async_to_generator$3(t){return function(){var r=this,n=arguments;return new Promise(function(l,u){var f=t.apply(r,n);function d(t){asyncGeneratorStep$3(f,l,u,d,h,"next",t)}function h(t){asyncGeneratorStep$3(f,l,u,d,h,"throw",t)}d(void 0)})}}function _class_call_check$6(t,r){if(!(t instanceof r))throw TypeError("Cannot call a class as a function")}function _defineProperties$6(t,r){for(var n=0;n<r.length;n++){var l=r[n];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function _create_class$6(t,r,n){return r&&_defineProperties$6(t.prototype,r),n&&_defineProperties$6(t,n),t}function _define_property$5(t,r,n){return r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function _get_prototype_of$6(t){return(_get_prototype_of$6=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits$6(t,r){if("function"!=typeof r&&null!==r)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_set_prototype_of$6(t,r)}function _possible_constructor_return$6(t,r){return r&&("object"===_type_of$7(r)||"function"==typeof r)?r:_assert_this_initialized$6(t)}function _set_prototype_of$6(t,r){return(_set_prototype_of$6=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function _type_of$7(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function _is_native_reflect_construct$6(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _create_super$6(t){var r=_is_native_reflect_construct$6();return function(){var n,l=_get_prototype_of$6(t);if(r){var u=_get_prototype_of$6(this).constructor;n=Reflect.construct(l,arguments,u)}else n=l.apply(this,arguments);return _possible_constructor_return$6(this,n)}}var{DCDFileManager}=ReactNative.NativeModules;!function(t){t.Plugins="plugin",t.Themes="theme"}(ManagerType||(ManagerType={}));var Manager=function(EventEmitter1){_inherits$6(Manager1,EventEmitter1);var _super=_create_super$6(Manager1);function Manager1(t){var r;return _class_call_check$6(this,Manager1),_define_property$5(_assert_this_initialized$6(r=_super.call(this)),"logger",void 0),_define_property$5(_assert_this_initialized$6(r),"settings",void 0),_define_property$5(_assert_this_initialized$6(r),"id",void 0),_define_property$5(_assert_this_initialized$6(r),"entities",new Map),_define_property$5(_assert_this_initialized$6(r),"started",new Set),_define_property$5(_assert_this_initialized$6(r),"errors",new Map),_define_property$5(_assert_this_initialized$6(r),"type",void 0),_define_property$5(_assert_this_initialized$6(r),"extension",void 0),_define_property$5(_assert_this_initialized$6(r),"path",void 0),_define_property$5(_assert_this_initialized$6(r),"name",void 0),r.type=t,r.name=capitalize(t)+"s",r.logger=createLogger("Manager",r.name),r.settings=getStore(`${t}-states`),r.path=`Enmity/${r.name}`,r}return _create_class$6(Manager1,[{key:"install",value:function(t){var r=this;return _async_to_generator$3(function*(){r.logger.debug(`Fetching ${t} for manifest...`);var n=yield fetch(t,{cache:"no-cache"}).then(t=>t.json());try{r.logger.debug("Validating manifest..."),r.validateManifest(n)}catch(t){return r.logger.debug("Failed to validate manifest:",t.message)}r.logger.debug(`Fetching bundle from ${n.bundle}...`);var l=yield fetch(n.bundle,{cache:"no-cache"}).then(t=>t.text());r.logger.debug("Done fetching..."),r.logger.debug("Saving..."),r.save(l,n),r.logger.debug("Loading..."),r.load(l,n)})()}},{key:"save",value:function(t,r){DCDFileManager.writeFile("documents",`${this.path}/${r.name}/bundle.${this.extension}`,t,"utf8"),DCDFileManager.writeFile("documents",`${this.path}/${r.name}/manifest.json`,JSON.stringify(r,null,2),"utf8")}},{key:"load",value:function(t,r){var n={failed:!1,instance:null};try{this.validateManifest(r);var l=this.handleBundle(t);l||this.handleInvalidBundle(),n.instance=l,(this.errors.has(r.id)||this.errors.has(r.path))&&(this.errors.delete(r.id),this.errors.delete(r.path))}catch(t){n.failed=!0,this.logger.error(`Failed to execute ${r.id}:`,t.message),this.errors.set(r.id??r.path,t)}var u={data:r,instance:n.instance,id:r.id,failed:n.failed,started:!1};this.entities.set(r.id,u),this.settings.get(r.id,!1)&&this.start(u),this.emit("updated")}},{key:"delete",value:function(t){var r=this.resolve(t);if(r)try{this.unload(r),DCDFileManager.writeFile("documents",`${this.path}/${r.data.name}/.delete`,"","utf8")}catch(t){this.logger.error(`Failed to delete ${r.data.id}:`,t.message)}}},{key:"start",value:function(t){var r=this.resolve(t);if(r)try{r.instance.start?.(),r.started=!0}catch(t){this.logger.error(`Failed to start ${r.data.id}:`,t.message),r.started=!1}}},{key:"stop",value:function(t){var r=this.resolve(t);if(r)try{r.instance.stop?.(),r.started=!1}catch(t){this.logger.error(`Failed to stop ${r.data.id}:`,t.message),r.started=!0}}},{key:"toggle",value:function(t){var r=this.resolve(t);if(r){var n=this.isEnabled(r.id);n?this.disable(r):this.enable(r),this.emit("toggle")}}},{key:"enable",value:function(t){var r=this.resolve(t);if(r)try{this.settings.set(r.id,!0),r.started||this.start(r)}catch(t){this.logger.error(`Failed to enable ${r.data.id}:`,t.message)}}},{key:"disable",value:function(t){var r=this.resolve(t);if(r)try{this.settings.set(r.id,!1),r.started&&this.stop(r)}catch(t){this.logger.error(`Failed to stop ${r.data.id}:`,t.message)}}},{key:"isEnabled",value:function(t){return!this.errors.has(t)&&this.settings.get(t,!1)}},{key:"unload",value:function(t){var r=this.resolve(t);if(r)try{r.started&&this.stop(r),this.entities.delete(r.id),this.emit("updated")}catch(t){this.logger.error(`FATAL: ${r.id} was not able to unload properly, a full app restart is recommended.`,t)}}},{key:"shutdown",value:function(){for(var t of this.addons)try{this.unload(t)}catch(r){this.logger.error(`Failed to stop ${t.id}. Skipping.`,r.message);continue}}},{key:"validateManifest",value:function(t){if(t.name&&"string"==typeof t.name){if(t.description&&"string"==typeof t.description){if(t.authors&&("object"==typeof t.name||Array.isArray(t.authors))){if(t.version&&"string"==typeof t.version&&Regex.SemanticVersioning.test(t.version)){if(!t.id||"string"!=typeof t.id)throw Error('Manifest property "id" must be of type string and match a "eternal.enmity" pattern.')}else throw Error('Manifest property "version" must be of type string and match the semantic versioning pattern.')}else throw Error('Manifest property "authors" must be of type array.')}else throw Error('Manifest property "description" must be of type string.')}else throw Error('Manifest property "name" must be of type string.')}},{key:"handleBundle",value:function handleBundle(bundle){var iife=eval(`() => { return ${bundle} }`),payload=iife(),res="function"==typeof payload?payload():payload;return res.default??res}},{key:"handleInvalidBundle",value:function(){throw Error("Bundle didn't return an instance.")}},{key:"resolve",value:function(t){if(t.data)return t;var r=this.entities.get(t);if(r)return r;var n=[...this.entities.values()].find(r=>r.data.name===t);if(n)return n}},{key:"useEntities",value:function(){var[,t]=React.useState({});return React.useEffect(()=>{function r(){t({})}return this.on("updated",r),this.on("toggle",r),()=>{this.off("updated",r),this.off("toggle",r)}},[]),this.addons}},{key:"addons",get:function(){return[...this.entities.values()]}}]),Manager1}(EventEmitter);function _assert_this_initialized$5(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _class_call_check$5(t,r){if(!(t instanceof r))throw TypeError("Cannot call a class as a function")}function _defineProperties$5(t,r){for(var n=0;n<r.length;n++){var l=r[n];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function _create_class$5(t,r,n){return r&&_defineProperties$5(t.prototype,r),n&&_defineProperties$5(t,n),t}function _define_property$4(t,r,n){return r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function _get_prototype_of$5(t){return(_get_prototype_of$5=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits$5(t,r){if("function"!=typeof r&&null!==r)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_set_prototype_of$5(t,r)}function _possible_constructor_return$5(t,r){return r&&("object"===_type_of$6(r)||"function"==typeof r)?r:_assert_this_initialized$5(t)}function _set_prototype_of$5(t,r){return(_set_prototype_of$5=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function _type_of$6(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function _is_native_reflect_construct$5(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _create_super$5(t){var r=_is_native_reflect_construct$5();return function(){var n,l=_get_prototype_of$5(t);if(r){var u=_get_prototype_of$5(this).constructor;n=Reflect.construct(l,arguments,u)}else n=l.apply(this,arguments);return _possible_constructor_return$5(this,n)}}var Themes$2=function(t){_inherits$5(n,t);var r=_create_super$5(n);function n(){var t;return _class_call_check$5(this,n),_define_property$4(_assert_this_initialized$5(t=r.call(this,ManagerType.Themes)),"original",void 0),_define_property$4(_assert_this_initialized$5(t),"extension","json"),_define_property$4(_assert_this_initialized$5(t),"module",void 0),t}return _create_class$5(n,[{key:"initialize",value:function(t){for(var r of(this.module=t,window.ENMITY_THEMES??[])){var{manifest:n,bundle:l}=r;this.load(l,n)}}},{key:"start",value:function(t){var r=this.resolve(t);if(r&&!r.failed&&this.isEnabled(r.id)){if(r.instance.raw)for(var[n,l]of(r.instance.raw.PRIMARY_660||(r.instance.raw.PRIMARY_660=r.instance?.semantic?.BACKGROUND_PRIMARY[0]),Object.entries(r.instance.raw)))this.module.RawColor[n]=l,this.module.default.unsafe_rawColors[n]=l;if(r.instance.semantic){var u=this.module.default.meta.resolveSemanticColor;this.module.default.meta.resolveSemanticColor=function(t,n){var l=n[Object.getOwnPropertySymbols(n)[0]];if(r.instance.semantic[l]){var f={dark:0,light:1,amoled:2}[t.toLowerCase()]||0,d=r.instance.semantic[l][f];if(d)return d}return u.call(this,t,n)}}this.emit("applied",r),this.logger.log(`${r.id} started.`)}}},{key:"toggle",value:function(t){var r=this.resolve(t);if(r){var n=this.isEnabled(r.id);n?this.disable(r):this.enable(r),this.emit("toggle")}}},{key:"enable",value:function(t){var r=this.resolve(t);if(r)try{this.settings.set("applied",r.id),r.started||this.start(r)}catch(t){this.logger.error(`Failed to enable ${r.data.id}:`,t.message)}}},{key:"disable",value:function(t){var r=this.resolve(t);if(r)try{this.settings.set("applied",null),r.started&&this.stop(r)}catch(t){this.logger.error(`Failed to stop ${r.data.id}:`,t.message)}}},{key:"isEnabled",value:function(t){return this.settings.get("applied",null)===t}},{key:"handleBundle",value:function(t){return"object"==typeof t?t:JSON.parse(t)}}]),n}(Manager),Themes$3=new Themes$2;function byProps(...t){return r=>{for(var n=0,l=t.length;n<l;n++)if(void 0===r[t[n]])return!1;return!0}}function byPrototypes(...t){return r=>{if(!r.prototype)return!1;for(var n=0,l=t.length;n<l;n++)if(void 0===r.prototype[t[n]])return!1;return!0}}function byDisplayName(t){return r=>r.displayName===t}function byName(t){return r=>r.name===t}function byStore(t,r=!0){return n=>n._dispatcher&&n.getName?.()===(r?t+"Store":t)}var Filters={byProps,byDisplayName,byPrototypes,byName,byStore};function _type_of$5(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}var data$2={cache:[],patchedMoment:!1,patchedThemes:!1};function find$1(t,r={}){var n=function(t){if(!modules[t].isInitialized)try{__r(t)}catch{return deenumerate(t),"continue"}var r=modules[t].publicModule.exports;if(!r||r===window||null===r[Symbol()]||isEmpty(r))return deenumerate(t),"continue";if(!data$2.patchedMoment&&r.defineLocale){var n=r.defineLocale,f=r.locale();r.defineLocale=function(...t){try{n.apply(this,t),r.locale(f)}catch(t){console.error("Failed to define moment locale:",t.message)}},data$2.patchedMoment=!0}if(!data$2.patchedThemes&&r.SemanticColor){try{Themes$3.initialize(r)}catch(t){console.error("Failed to patch themes:",t.message)}data$2.patchedThemes=!0}if($(r,t)){data$2.cache[t]=r;var d=g?modules[t]:r;if(!l)return{v:d};y.found.push(d)}if(h&&r.default&&$(r.default,t)){data$2.cache[t]=r;var E=g?modules[t]:u?r.default:r;if(!l)return{v:E};y.found.push(E)}};if(!t)throw Error("You must provide a filter to search by.");var{all:l=!1,interop:u=!0,cache:f=!0,initial:d=null,esModules:h=!0,raw:g=!1}=r,y={found:d??[],errored:!1},$=(r,n)=>{try{return t(r,n)}catch(t){if(y.errored)return;y.errored=!0,console.error("Search filter threw an error, degrading performance.","This will create a bad experience for the user including lag spikes, a slow startup, etc.","Please fix this as soon as possible.","\n",t.stack)}},E=f?data$2.cache:modules;for(var T in E){var R=n(T);if("object"===_type_of$5(R))return R.v}return!f||l||y.found.length?f&&l?find$1(t,Object.assign(r,{cache:!1,initial:y.found})):l?y.found:null:find$1(t,Object.assign(r,{cache:!1}))}function bulk(...t){var r=Array(t.length);return find$1((n,l)=>{for(var u=0,f=t.length;u<f;u++){var d=t[u];d.filter&&(d.filter(n,l)&&(r[u]=n),n.default&&d.filter(n.default,l)&&(r[u]=d.interop??!0?n.default:n))}return r.filter(String).length===search.length},{interop:!1,esModules:!1}),r}function findByProps(...t){var[r,n]=parseOptions(t);return search(r,n,"byProps")}function findByPrototypes(...t){var[r,n]=parseOptions(t);return search(r,n,"byPrototypes")}function findStore(...t){var[[r],{short:n=!0,...l}]=parseOptions(t);return search([r,n],l,"byStore")}function findByName(...t){var[r,n]=parseOptions(t);return search(r,n,"byName")}function search(t,r,n){if(r.lazy){var l;return new Proxy({__METRO_LAZY__:!0,get module(){return l}},{get(u,f){if(f&&"string"==typeof f)return(l??=search(t,Object.assign(r,{lazy:!1}),n),"module"===f)?l:l?.[f]},set:(u,f,d)=>Object.defineProperty((l??=search(t,Object.assign(r,{lazy:!1}),n))??{},f,{value:d,writable:!0,configurable:!0})})}if("string"==typeof n&&(n=Filters[n]),n)return r.bulk?bulk(...t.map(t=>!Array.isArray(t)&&"object"==typeof t&&t.params?{filter:n(...t.params??[]),...t}:{filter:n(...t),interop:!0})):find$1(n(...t),r)}function parseOptions(t,r=t=>"object"==typeof t&&!Array.isArray(t),n={}){return[t,r(t[t.length-1])?t.pop():n]}function deenumerate(t){Object.defineProperty(modules,t,{value:modules[t],enumerable:!1,configurable:!0,writable:!0})}var Modules=Object.freeze({__proto__:null,bulk:bulk,find:find$1,findByName:findByName,findByProps:findByProps,findByPrototypes:findByPrototypes,findStore:findStore}),Patcher$2=createPatcher("no-track"),data$1={id:"misc.anti-track",default:!0};function initialize$3(){var[t,r,n]=findByProps({params:["trackWithMetadata"]},{params:["AnalyticsActionHandlers"]},{params:["encodeProperties","track"]},{bulk:!0});attempt(()=>Patcher$2.instead(t,"trackWithMetadata",noop)),attempt(()=>Patcher$2.instead(r.AnalyticsActionHandlers,"handleConnectionClosed",noop)),attempt(()=>Patcher$2.instead(r.AnalyticsActionHandlers,"handleConnectionOpen",noop)),attempt(()=>Patcher$2.instead(r.AnalyticsActionHandlers,"handleFingerprint",noop)),attempt(()=>Patcher$2.instead(r.AnalyticsActionHandlers,"handleTrack",noop)),attempt(()=>Patcher$2.instead(n,"track",noop))}function shutdown$3(){Patcher$2.unpatchAll()}var antiTrack=Object.freeze({__proto__:null,data:data$1,initialize:initialize$3,shutdown:shutdown$3}),Flux=findByProps("Store","connectStores",{lazy:!0}),Moment=findByProps("isMoment"),ReactNative$1=window.ReactNative,React$1=window.React,Chroma=window.Chroma,StyleSheet=findByProps("createThemedStyleSheet",{lazy:!0}),Constants=findByProps("API_HOST","Endpoints",{lazy:!0}),Dispatcher=findByProps("_dispatch",{lazy:!0}),Theme$1=findByProps("colors","meta",{lazy:!0}),REST=findByProps("getAPIBaseURL",{lazy:!0}),i18n$1=findByProps("Messages",{lazy:!0}),Common=Object.freeze({__proto__:null,Chroma:Chroma,Constants:Constants,Dispatcher:Dispatcher,Flux:Flux,Moment:Moment,REST:REST,React:React$1,ReactNative:ReactNative$1,StyleSheet:StyleSheet,Theme:Theme$1,i18n:i18n$1}),Logger$3=createLogger("Debug","WebSocket"),data={id:"dev.debugBridge",settings:["dev.debugBridgeHost"],default:!1};function initialize$2(isReconnect=!1){var settings=getStore("enmity");try{ws=new WebSocket(`ws://${settings.get("dev.debugBridgeHost","192.168.0.35:9090")}`)}catch(e){alert("Failed to connect to the debug websocket. Make sure the host is reachable."),Logger$3.error(e.message)}ws?.addEventListener("open",()=>{Logger$3.success(isReconnect?"Reconnected.":"Connected.")}),ws?.addEventListener("message",message=>{try{Logger$3.log(eval(message.data))}catch(e){Logger$3.error(e)}}),globalThis._nativeLoggingHook=nativeLoggingHook,globalThis.nativeLoggingHook=function(t,r){return ws?.readyState===WebSocket.OPEN&&ws.send(JSON.stringify({level:r,message:t})),globalThis._nativeLoggingHook.apply(this,arguments)};var{remove}=ReactNative$1.AppState?.addEventListener("change",t=>{switch(t){case"active":if(ws||ws?.readyState===WebSocket.OPEN)return;remove(),initialize$2(!0);break;case"background":shutdown$2()}})}function shutdown$2(){globalThis._nativeLoggingHook&&(globalThis.nativeLoggingHook=globalThis._nativeLoggingHook),ws?.readyState===WebSocket.OPEN&&(ws.close(),ws=null)}var debug=Object.freeze({__proto__:null,data:data,initialize:initialize$2,shutdown:shutdown$2,get ws(){return ws}}),instances=Object.freeze({__proto__:null,AntiTrack:antiTrack,Debug:debug}),Logger$2=createLogger("Core","Built-Ins"),settings$1=Storage.getStore("enmity"),started=new Set;function initialize$1(){for(var t in instances){var r=instances[t];settings$1.get(r.data.id,r.data.default??!0)&&start(t)}}function shutdown$1(){for(var t of started)stop(t)}function start(t){if(instances[t]&&!started.has(t)){var r=instances[t];try{r.initialize?.(),started.add(t)}catch(r){started.delete(t),Logger$2.error(`Failed to initialize built-in ${t}:`,r.message)}}}function stop(t){if(instances[t]&&started.has(t)){var r=instances[t];try{r.shutdown?.(),started.delete(t)}catch(r){started.add(t),Logger$2.error(`Failed to shutdown built-in ${t}:`,r.message)}}}function onSettingsChange({store:t,key:r,value:n}){if("enmity"===t)for(var l in instances){var u=instances[l];u.data.id===r?(n?start:stop)(l):u.data.settings?.includes(r)&&started.has(l)&&(stop(l),start(l))}}Storage.on("changed",onSettingsChange);var BuiltIns={initialize:initialize$1,shutdown:shutdown$1,start,stop},Guilds=findStore("Guild",{lazy:!0}),Theme=findStore("Theme",{lazy:!0}),Users=findStore("User",{lazy:!0}),Stores=Object.freeze({__proto__:null,Guilds:Guilds,Theme:Theme,Users:Users}),Themes$1=findByProps("updateTheme","overrideTheme",{lazy:!0}),Dialog=findByProps("show","close","openLazy",{lazy:!0}),Profiles=findByProps("showUserProfile",{lazy:!0}),UI=Object.freeze({__proto__:null,Dialog:Dialog,Profiles:Profiles,Themes:Themes$1});function apply$3(){Dispatcher?.subscribe&&Dispatcher.subscribe("CONNECTION_OPEN",handler)}function remove$3(){Dispatcher?.subscribe&&Dispatcher.unsubscribe("CONNECTION_OPEN",handler)}function handler(){Themes$1.overrideTheme(Theme.theme)}var themeFix=Object.freeze({__proto__:null,apply:apply$3,remove:remove$3}),Native=findByProps("Button","View","Text",{lazy:!0}),Forms=findByProps("Form","FormSection",{lazy:!0}),SVG=findByProps("Svg","Path",{lazy:!0}),Search=findByName("StaticSearchBarContainer"),Media=findByProps("openMediaModal"),Navigation=findByProps("useNavigation",{lazy:!0}),Components=Object.freeze({__proto__:null,Forms:Forms,Media:Media,Native:Native,Navigation:Navigation,SVG:SVG,Search:Search}),assets=new Set,registry=findByProps("registerAsset");Patcher$3.after("enmity-assets",registry,"registerAsset",(t,[r],n)=>{Object.assign(r,{id:n}),assets.add(r)});for(var id=1;;id++){var asset=registry.getAssetByID(id);if(!asset)break;assets.has(asset)||(Object.assign(asset,{id}),assets.add(asset))}function find(t){return Object.values(assets).find(t)}function getByName$1(t,r="png"){return[...assets].find(n=>n.name===t&&n.type===r)}function getByID(t){return registry.getAssetByID(t)}function getIDByName(t,r="png"){return getByName$1(t,r)?.id}var Icons=new Proxy({},{get:(t,r)=>getIDByName(r)}),Assets={assets,getByName:getByName$1,getByID,getIDByName},assets$1=Object.freeze({__proto__:null,Icons:Icons,assets:assets,default:Assets,find:find,getByID:getByID,getByName:getByName$1,getIDByName:getIDByName,registry:registry}),{colors:colors$5}=Theme$1,styles$4=StyleSheet.createThemedStyleSheet({icon:{color:colors$5.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});function palette({height:t,width:r,color:n=styles$4.icon.color,...l}){return React$1.createElement(SVG.Svg,{viewBox:"0 0 24 24",style:{height:t,width:r,...styles$4.icon,color:n},fill:"currentColor",...l},React$1.createElement(SVG.Path,{d:"M0 0h24v24H0z",fill:"none"}),React$1.createElement(SVG.Path,{d:"M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"}))}var{colors:colors$4}=Theme$1,styles$3=StyleSheet.createThemedStyleSheet({icon:{color:colors$4.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});function puzzle({height:t,width:r,color:n=styles$3.icon.color,...l}){return React$1.createElement(SVG.Svg,{viewBox:"0 0 24 24",style:{height:t,width:r,...styles$3.icon,color:n},fill:"currentColor",...l},React$1.createElement(SVG.Path,{d:"M0 0h24v24H0z",fill:"none"}),React$1.createElement(SVG.Path,{d:"M20.5 11H19V7c0-1.1-.9-2-2-2h-4V3.5C13 2.12 11.88 1 10.5 1S8 2.12 8 3.5V5H4c-1.1 0-1.99.9-1.99 2v3.8H3.5c1.49 0 2.7 1.21 2.7 2.7s-1.21 2.7-2.7 2.7H2V20c0 1.1.9 2 2 2h3.8v-1.5c0-1.49 1.21-2.7 2.7-2.7 1.49 0 2.7 1.21 2.7 2.7V22H17c1.1 0 2-.9 2-2v-4h1.5c1.38 0 2.5-1.12 2.5-2.5S21.88 11 20.5 11z"}))}var Invites=findByProps("acceptInviteAndTransitionToInviteChannel",{lazy:!0}),Actions=Object.freeze({__proto__:null,Invites:Invites});function _assert_this_initialized$4(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _class_call_check$4(t,r){if(!(t instanceof r))throw TypeError("Cannot call a class as a function")}function _defineProperties$4(t,r){for(var n=0;n<r.length;n++){var l=r[n];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function _create_class$4(t,r,n){return r&&_defineProperties$4(t.prototype,r),n&&_defineProperties$4(t,n),t}function _define_property$3(t,r,n){return r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function _get_prototype_of$4(t){return(_get_prototype_of$4=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits$4(t,r){if("function"!=typeof r&&null!==r)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_set_prototype_of$4(t,r)}function _possible_constructor_return$4(t,r){return r&&("object"===_type_of$4(r)||"function"==typeof r)?r:_assert_this_initialized$4(t)}function _set_prototype_of$4(t,r){return(_set_prototype_of$4=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function _type_of$4(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function _is_native_reflect_construct$4(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _create_super$4(t){var r=_is_native_reflect_construct$4();return function(){var n,l=_get_prototype_of$4(t);if(r){var u=_get_prototype_of$4(this).constructor;n=Reflect.construct(l,arguments,u)}else n=l.apply(this,arguments);return _possible_constructor_return$4(this,n)}}var Plugins$1=function(t){_inherits$4(n,t);var r=_create_super$4(n);function n(){var t;return _class_call_check$4(this,n),_define_property$3(_assert_this_initialized$4(t=r.call(this,ManagerType.Plugins)),"extension","js"),t.initialize(),t}return _create_class$4(n,[{key:"initialize",value:function(){for(var t of window.ENMITY_PLUGINS??[]){var{manifest:r,bundle:n}=t;this.load(n,r)}}}]),n}(Manager),Plugins$2=new Plugins$1;function _assert_this_initialized$3(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _class_call_check$3(t,r){if(!(t instanceof r))throw TypeError("Cannot call a class as a function")}function _defineProperties$3(t,r){for(var n=0;n<r.length;n++){var l=r[n];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function _create_class$3(t,r,n){return r&&_defineProperties$3(t.prototype,r),n&&_defineProperties$3(t,n),t}function _get_prototype_of$3(t){return(_get_prototype_of$3=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits$3(t,r){if("function"!=typeof r&&null!==r)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_set_prototype_of$3(t,r)}function _possible_constructor_return$3(t,r){return r&&("object"===_type_of$3(r)||"function"==typeof r)?r:_assert_this_initialized$3(t)}function _set_prototype_of$3(t,r){return(_set_prototype_of$3=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function _type_of$3(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function _is_native_reflect_construct$3(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _create_super$3(t){var r=_is_native_reflect_construct$3();return function(){var n,l=_get_prototype_of$3(t);if(r){var u=_get_prototype_of$3(this).constructor;n=Reflect.construct(l,arguments,u)}else n=l.apply(this,arguments);return _possible_constructor_return$3(this,n)}}var{Fonts:Fonts$2}=Constants,{colors:colors$3}=Theme$1,styles$2=StyleSheet.createThemedStyleSheet({label:{fontFamily:Fonts$2.DISPLAY_SEMIBOLD,color:colors$3.TEXT_NORMAL,fontSize:16},image:{width:24,height:24}}),_class$2=function(t){_inherits$3(n,t);var r=_create_super$3(n);function n(){return _class_call_check$3(this,n),r.apply(this,arguments)}return _create_class$3(n,[{key:"render",value:function(){var{item:t}=this.props;return React$1.createElement(Forms.FormRow,{label:()=>React$1.createElement(ReactNative$1.Text,{style:styles$2.label},t.name),leading:()=>React$1.createElement(ReactNative$1.Image,{style:styles$2.image,source:t.id}),subLabel:t.type.toUpperCase(),onPress:this.open.bind(this)})}},{key:"open",value:function(){Media.openMediaModal}}]),n}(React$1.PureComponent);function AssetBrowser(){var[t,r]=React$1.useState(),n=[...assets.values()].filter(t=>"png"===t.type),l=t?[]:n;if(t)for(var u of n)(u.name.toLowerCase().includes(t)||u.httpServerLocation.toLowerCase().includes(t))&&l.push(u);return React$1.createElement(ReactNative$1.View,null,React$1.createElement(Search,{placeholder:i18n$1.Messages.ENMITY_SEARCH_ASSETS,onChangeText:t=>r(t),onClear:()=>r(""),value:t}),React$1.createElement(Forms.FormSection,{style:{flex:1}},React$1.createElement(ReactNative$1.FlatList,{keyExtractor:(t,r)=>String(r),data:l,ItemSeparatorComponent:Forms.FormDivider,renderItem:({item:t})=>React$1.createElement(_class$2,{item:t})})))}function createStore(t){var r=new Set,n=Object.freeze({getState:(r=t=>t)=>r(t),setState(n){var l="function"==typeof n?n(t):n;if(!Object.is(t,l))for(var u of(t=Object.assign({},t,l),r))try{u(t)}catch{console.error("Failed to fire listener in zustand store.")}},addListener(t){if(!r.has(t))return r.add(t),()=>r.delete(t)},removeListener:t=>r.delete(t),get listeners(){return r}});function l(t=t=>t){var[,l]=React$1.useReducer(t=>t+1,0);return React$1.useEffect(()=>{var t=()=>l();return r.add(t),()=>void r.delete(t)},[]),n.getState(t)}return Object.assign(l,n,{*[Symbol.iterator](){yield n,yield l}}),l}var[store,useStore]=createStore({logs:[]});function addLog({message:t,level:r}){store.setState(n=>({logs:[...n.logs,{time:Date.now(),message:t,level:r}]}))}var Logger$1={store,useStore},{Fonts:Fonts$1}=Constants,{colors:colors$2}=Theme$1;function Logs(){var t=Navigation.useNavigation(),r=Logger$1.useStore();return React$1.useEffect(()=>{t.setOptions({headerRight:HeaderRight$1})},[]),React$1.createElement(Forms.FormSection,{style:{flex:1}},React$1.createElement(ReactNative$1.FlatList,{data:r.logs.sort((t,r)=>t.time-r.time),keyExtractor:(t,r)=>String(r),ListEmptyComponent:()=>React$1.createElement(ReactNative$1.Text,null,"nothing here!"),ItemSeparatorComponent:Forms.FormDivider,renderItem:({item:t})=>{var r=StyleSheet.createThemedStyleSheet({log:{fontSize:16,fontFamily:Fonts$1.DISPLAY_SEMIBOLD,color:(()=>{switch(t.level){case 1:return colors$2.TEXT_NORMAL;case 0:return colors$2.TEXT_MUTED;case 2:return"yellow";case 3:return"red"}})()},time:{fontSize:16,fontFamily:Fonts$1.DISPLAY_SEMIBOLD,color:colors$2.TEXT_MUTED}});return React$1.createElement(Forms.FormRow,{label:()=>React$1.createElement(ReactNative$1.Text,{style:r.log},t.message),subLabel:Moment(t.time).format("HH:mm:ss.SSS")})}}))}var styles$1=StyleSheet.createThemedStyleSheet({touchable:{marginRight:10},image:{tintColor:colors$2.TEXT_NORMAL}});function HeaderRight$1(){return React$1.createElement(ReactNative$1.TouchableOpacity,{style:styles$1.touchable,onPress:()=>Logger$1.store.setState({logs:[]})},React$1.createElement(ReactNative$1.Image,{style:styles$1.image,source:Assets.getIDByName("ic_input_clear_24px")}))}function Developer(){var t=Navigation.useNavigation(),r=useSettingsStore("enmity"),n={Debug:Assets.getIDByName("debug")};return React$1.createElement(React$1.Fragment,null,React$1.createElement(Forms.FormSection,{title:i18n$1.Messages.ENMITY_DEBUG_BRIDGE},React$1.createElement(Forms.FormRow,{label:i18n$1.Messages.ENMITY_DEBUG_BRIDGE_CONNECT,trailing:React$1.createElement(Forms.FormSwitch,{value:r.get("dev.debugBridge",!1),onValueChange:()=>r.toggle("dev.debugBridge",!1)})}),r.get("dev.debugBridge",!1)&&React$1.createElement(React$1.Fragment,null,React$1.createElement(Forms.FormDivider,null),React$1.createElement(Forms.FormInput,{value:r.get("dev.debugBridgeHost","192.168.0.35:9090"),onChange:t=>r.set("dev.debugBridgeHost",t),title:i18n$1.Messages.ENMITY_DEBUG_BRIDGE_IP}))),React$1.createElement(Forms.FormSection,null,React$1.createElement(Forms.FormRow,{label:i18n$1.Messages.ENMITY_ASSET_BROWSER,leading:React$1.createElement(Forms.FormRow.Icon,{source:n.Debug}),trailing:Forms.FormRow.Arrow,onPress:()=>t.push(Screens.Custom,{title:i18n$1.Messages.ENMITY_ASSET_BROWSER,render:AssetBrowser})}),React$1.createElement(Forms.FormDivider,null),React$1.createElement(Forms.FormRow,{label:i18n$1.Messages.ENMITY_DEBUG_LOGS,leading:React$1.createElement(Forms.FormRow.Icon,{source:n.Debug}),trailing:Forms.FormRow.Arrow,onPress:()=>t.push(Screens.Custom,{title:i18n$1.Messages.ENMITY_DEBUG_LOGS,render:Logs})})))}var Toasts=()=>React$1.createElement(ReactNative$1.Text,null,"Placeholder."),{colors:colors$1}=Theme$1,styles=StyleSheet.createThemedStyleSheet({trailingText:{color:colors$1.TEXT_MUTED},container:{marginBottom:50}});function General(){var t=Navigation.useNavigation(),r={Twitter:Assets.getIDByName("img_account_sync_twitter_white"),GitHub:Assets.getIDByName("img_account_sync_github_white"),Development:Assets.getIDByName("ic_progress_wrench_24px"),Toasts:Assets.getIDByName("ic_notification_settings"),Discord:Assets.getIDByName("Discord")};return React$1.createElement(ReactNative$1.ScrollView,null,React$1.createElement(ReactNative$1.KeyboardAvoidingView,{enabled:!0,behavior:"position",style:styles.container,keyboardVerticalOffset:100,contentContainerStyle:{backfaceVisibility:"hidden"}},React$1.createElement(Forms.FormSection,null,React$1.createElement(Forms.FormRow,{label:i18n$1.Messages.ENMITY_TOAST_SETTINGS,leading:React$1.createElement(Forms.FormRow.Icon,{source:r.Toasts}),trailing:Forms.FormRow.Arrow,onPress:()=>t.push(Screens.Custom,{title:i18n$1.Messages.ENMITY_TOAST_SETTINGS,render:Toasts})}),React$1.createElement(Forms.FormDivider,null),React$1.createElement(Forms.FormRow,{label:i18n$1.Messages.ENMITY_DEVELOPMENT_SETTINGS,leading:React$1.createElement(Forms.FormRow.Icon,{source:r.Development}),trailing:Forms.FormRow.Arrow,onPress:()=>t.push(Screens.Custom,{title:i18n$1.Messages.ENMITY_DEVELOPMENT_SETTINGS,render:Developer})})),React$1.createElement(Forms.FormSection,{title:"Stats"},React$1.createElement(Forms.FormRow,{label:"Installed Plugins",leading:React$1.createElement(puzzle,{width:24,height:24}),trailing:()=>React$1.createElement(ReactNative$1.Text,{style:styles.trailingText},Plugins$2.addons.length)}),React$1.createElement(Forms.FormDivider,null),React$1.createElement(Forms.FormRow,{label:"Installed Themes",leading:React$1.createElement(palette,{width:24,height:24}),trailing:()=>React$1.createElement(ReactNative$1.Text,{style:styles.trailingText},Themes$3.addons.length)})),React$1.createElement(Forms.FormSection,{title:"Links"},React$1.createElement(Forms.FormRow,{label:"Discord Server",leading:React$1.createElement(Forms.FormRow.Icon,{source:r.Discord}),trailing:Forms.FormRow.Arrow,onPress:()=>Invites.acceptInviteAndTransitionToInviteChannel({inviteKey:Invite})}),React$1.createElement(Forms.FormDivider,null),React$1.createElement(Forms.FormRow,{label:"GitHub",leading:React$1.createElement(Forms.FormRow.Icon,{source:r.GitHub}),trailing:Forms.FormRow.Arrow,onPress:()=>ReactNative$1.Linking.openURL(Links.GitHub)}),React$1.createElement(Forms.FormDivider,null),React$1.createElement(Forms.FormRow,{label:"Twitter",leading:React$1.createElement(Forms.FormRow.Icon,{source:r.Twitter}),trailing:Forms.FormRow.Arrow,onPress:()=>ReactNative$1.Linking.openURL(Links.Twitter)}))))}function _assert_this_initialized$2(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _class_call_check$2(t,r){if(!(t instanceof r))throw TypeError("Cannot call a class as a function")}function _defineProperties$2(t,r){for(var n=0;n<r.length;n++){var l=r[n];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function _create_class$2(t,r,n){return r&&_defineProperties$2(t.prototype,r),n&&_defineProperties$2(t,n),t}function _define_property$2(t,r,n){return r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function _get_prototype_of$2(t){return(_get_prototype_of$2=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits$2(t,r){if("function"!=typeof r&&null!==r)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_set_prototype_of$2(t,r)}function _possible_constructor_return$2(t,r){return r&&("object"===_type_of$2(r)||"function"==typeof r)?r:_assert_this_initialized$2(t)}function _set_prototype_of$2(t,r){return(_set_prototype_of$2=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function _type_of$2(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function _is_native_reflect_construct$2(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _create_super$2(t){var r=_is_native_reflect_construct$2();return function(){var n,l=_get_prototype_of$2(t);if(r){var u=_get_prototype_of$2(this).constructor;n=Reflect.construct(l,arguments,u)}else n=l.apply(this,arguments);return _possible_constructor_return$2(this,n)}}var InstallModal=function(t){_inherits$2(n,t);var r=_create_super$2(n);function n(){var t;return _class_call_check$2(this,n),t=r.apply(this,arguments),_define_property$2(_assert_this_initialized$2(t),"state",{url:""}),_define_property$2(_assert_this_initialized$2(t),"styles",StyleSheet.createThemedStyleSheet({input:{height:40,borderBottomWidth:2,marginTop:10,borderBottomColor:Theme$1.colors.CONTROL_BRAND_FOREGROUND_NEW??Theme$1.colors.CONTROL_BRAND_FOREGROUND,color:Theme$1.colors.TEXT_NORMAL}})),t}return _create_class$2(n,[{key:"render",value:function(){return React.createElement(React.Fragment,null,React.createElement(ReactNative$1.TextInput,{style:this.styles.input,onChangeText:t=>this.setState({url:t}),value:this.state.url,placeholder:"https://example.com/",autoFocus:!0}))}},{key:"getInput",value:function(){return this.state.url}}]),n}(React.PureComponent),AsyncUsers=findByProps("fetchProfile",{lazy:!0}),API$1=Object.freeze({__proto__:null,AsyncUsers:AsyncUsers}),{DCDDeviceManager,BundleUpdaterManager}=ReactNative$1.NativeModules,BundleInfo=ReactNative$1.NativeModules.InfoDictionaryManager??ReactNative$1.NativeModules.RTNClientInfoManager,BundleManager=BundleUpdaterManager,DeviceInfo=DCDDeviceManager,reload=()=>BundleUpdaterManager.reload(),native=Object.freeze({__proto__:null,BundleInfo:BundleInfo,BundleManager:BundleManager,DeviceInfo:DeviceInfo,reload:reload});function _assert_this_initialized$1(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function asyncGeneratorStep$2(t,r,n,l,u,f,d){try{var h=t[f](d),g=h.value}catch(t){n(t);return}h.done?r(g):Promise.resolve(g).then(l,u)}function _async_to_generator$2(t){return function(){var r=this,n=arguments;return new Promise(function(l,u){var f=t.apply(r,n);function d(t){asyncGeneratorStep$2(f,l,u,d,h,"next",t)}function h(t){asyncGeneratorStep$2(f,l,u,d,h,"throw",t)}d(void 0)})}}function _class_call_check$1(t,r){if(!(t instanceof r))throw TypeError("Cannot call a class as a function")}function _defineProperties$1(t,r){for(var n=0;n<r.length;n++){var l=r[n];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function _create_class$1(t,r,n){return r&&_defineProperties$1(t.prototype,r),n&&_defineProperties$1(t,n),t}function _define_property$1(t,r,n){return r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function _get_prototype_of$1(t){return(_get_prototype_of$1=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits$1(t,r){if("function"!=typeof r&&null!==r)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_set_prototype_of$1(t,r)}function _possible_constructor_return$1(t,r){return r&&("object"===_type_of$1(r)||"function"==typeof r)?r:_assert_this_initialized$1(t)}function _set_prototype_of$1(t,r){return(_set_prototype_of$1=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function _type_of$1(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function _is_native_reflect_construct$1(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _create_super$1(t){var r=_is_native_reflect_construct$1();return function(){var n,l=_get_prototype_of$1(t);if(r){var u=_get_prototype_of$1(this).constructor;n=Reflect.construct(l,arguments,u)}else n=l.apply(this,arguments);return _possible_constructor_return$1(this,n)}}var{Fonts}=Constants,{colors}=Theme$1,_class$1=function(t){_inherits$1(n,t);var r=_create_super$1(n);function n(){var t;return _class_call_check$1(this,n),t=r.apply(this,arguments),_define_property$1(_assert_this_initialized$1(t),"styles",StyleSheet.createThemedStyleSheet({card:{backgroundColor:colors.BACKGROUND_SECONDARY,marginHorizontal:10,borderRadius:5,marginTop:10},failed:{opacity:.5},error:{color:"red",marginTop:10},header:{backgroundColor:colors.BACKGROUND_TERTIARY,borderTopRightRadius:5,borderTopLeftRadius:5,paddingHorizontal:15,flexDirection:"row",alignItems:"center",padding:10,flex:1},name:{color:colors.TEXT_NORMAL,fontFamily:Fonts.PRIMARY_BOLD,marginRight:2.5,fontSize:16},version:{fontFamily:Fonts.PRIMARY_SEMIBOLD,color:colors.TEXT_MUTED,marginRight:2.5,fontSize:14},by:{fontFamily:Fonts.PRIMARY_NORMAL,color:colors.TEXT_MUTED,marginRight:2.5,fontSize:14},authors:{fontFamily:Fonts.PRIMARY_SEMIBOLD,color:colors.TEXT_MUTED,fontSize:14,flex:1},authorContainer:{flexDirection:"row"},touchable:{color:colors.TEXT_NORMAL},info:{padding:15},description:{fontFamily:Fonts.PRIMARY_SEMIBOLD,color:colors.TEXT_NORMAL,fontSize:14}})),t}return _create_class$1(n,[{key:"render",value:function(){var{addon:t,manager:r,shouldRestart:n}=this.props;return React$1.createElement(ReactNative$1.View,{style:{...this.styles.card,...t.failed?this.styles.failed:{}}},React$1.createElement(ReactNative$1.View,{style:this.styles.header},this.renderMetadata(),this.renderAuthors(),React$1.createElement(ReactNative$1.Switch,{onChange:()=>{r.toggle(t.id),n&&Dialog.confirm({title:i18n$1.Messages.ENMITY_CHANGE_RESTART,body:i18n$1.Messages.ENMITY_CHANGE_RESTART_DESC,confirmText:i18n$1.Messages.ENMITY_RESTART,onConfirm:_async_to_generator$2(function*(){return yield reload()})})},disabled:t.failed,value:r.isEnabled(t.id)})),React$1.createElement(ReactNative$1.View,{style:this.styles.info},this.renderBody()))}},{key:"renderMetadata",value:function(){var{addon:t}=this.props;return React$1.createElement(React$1.Fragment,null,React$1.createElement(ReactNative$1.Text,{style:this.styles.name},t.data.name),React$1.createElement(ReactNative$1.Text,{style:this.styles.version},t.data.version??"?.?.?"))}},{key:"renderAuthors",value:function(){var{addon:t}=this.props;return React$1.createElement(React$1.Fragment,null,React$1.createElement(ReactNative$1.Text,{style:this.styles.by},"by"),React$1.createElement(ReactNative$1.FlatList,{data:t.data.authors??[{name:"???"}],horizontal:!0,style:{flex:1},keyExtractor:(t,r)=>String(r),renderItem:({item:r,index:n})=>{var l=n!==(t.data.authors??[{name:"???"}]).length-1&&React$1.createElement(ReactNative$1.Text,{style:this.styles.authors},", ");return r.name&&r.id?React$1.createElement(ReactNative$1.TouchableOpacity,{style:this.styles.authorContainer,onPress:this.onTapAuthor.bind(this,r)},React$1.createElement(ReactNative$1.Text,{style:{...this.styles.authors,...this.styles.touchable}},r.name),l):React$1.createElement(ReactNative$1.View,{style:this.styles.authorContainer},React$1.createElement(ReactNative$1.Text,{style:this.styles.authors},r.name??r),l)}}))}},{key:"renderBody",value:function(){var{addon:t,manager:r}=this.props,n=r.errors.get(t.id??t.data.path);return React$1.createElement(React$1.Fragment,null,React$1.createElement(ReactNative$1.Text,{style:this.styles.description},t.data.description??i18n$1.Messages.ENMITY_ADDON_NO_DESCRIPTION),t.failed&&React$1.createElement(ReactNative$1.Text,{style:{...this.styles.description,...this.styles.error}},i18n$1.Messages.ENMITY_ADDON_FAILED.format({error:n.message})))}},{key:"onTapAuthor",value:function(t){return _async_to_generator$2(function*(){Users.getUser(t.id)||(yield AsyncUsers.fetchProfile(t.id)),Profiles.showUserProfile({userId:t.id})})()}}]),n}(React$1.Component),Patcher$1=createPatcher("components"),unknown=new Set,named=new Map;function traverse(t){if(t?.type&&"string"!=typeof t.type){var r=t.type;r.displayName?add$1(r.displayName,r):r.name?add$1(r.name,r):r.type?.name?add$1(r.type.name,r):r.type?.displayName?add$1(r.type.displayName,r):r.render?.displayName?add$1(r.render.displayName,r):r.render?.name?add$1(r.render.name,r):unknown.add(r);var{children:n}=t.props||{};for(var l of n?Array.isArray(n)?n:[n]:[])traverse(l)}}function add$1(t,r){named.get(t)||named.set(t,r)}function getAll(){return{named:Object.fromEntries(named.entries()),unknown:[...unknown.values()]}}function getByName(t){return named.get(t)}Patcher$1.before(window.React,"createElement",(t,r)=>{var[n]=r;return n&&traverse(n),"function"==typeof n&&void 0!==n.renderPatched&&(r[0]=n.renderPatched),r}),Patcher$1.after(React,"createElement",(t,r,n)=>{n&&traverse(n)});var components=Object.freeze({__proto__:null,add:add$1,getAll:getAll,getByName:getByName}),managers=Object.freeze({__proto__:null,plugins:Plugins$2,themes:Themes$3}),utilities=Object.freeze({__proto__:null,attempt:attempt,capitalize:capitalize,colorize:colorize,debounce:debounce,findInReactTree:findInReactTree,findInTree:findInTree,forceRender:forceRender,isEmpty:isEmpty,noop:noop,uuid:uuid}),toasts=Object.freeze({__proto__:null}),ENMITY_GENERAL="General",ENMITY_PLUGINS="Plugins",ENMITY_THEMES="Themes",ENMITY_UPDATER="Updater",ENMITY_DEBUG_LOGS="Debug Logs",ENMITY_SEARCH_PLUGINS="Search plugins...",ENMITY_SEARCH_THEMES="Search themes...",ENMITY_SEARCH_ASSETS="Search assets...",ENMITY_DEVELOPMENT_SETTINGS="Development Settings",ENMITY_DEBUG_BRIDGE_IP="Debug IP",ENMITY_DEBUG_BRIDGE_CONNECT="Connect to the debug bridge on startup",ENMITY_DEBUG_BRIDGE="Debug Bridge",ENMITY_TOAST_SETTINGS="Toast Settings",ENMITY_ASSET_BROWSER="Asset Browser",ENMITY_ADDON_NO_DESCRIPTION="No description provided.",ENMITY_ADDON_FAILED="This addon failed to load: {error}",ENMITY_INSTALL="Install",ENMITY_INSTALL_TITLE="Install {type}",ENMITY_THEME_EDITOR="Theme Editor",ENMITY_THEME_GET_DESC="Would you like to create or import a theme?",ENMITY_THEME_GET_OPTION_CREATE="Create",ENMITY_THEME_GET_OPTION_IMPORT="Import",ENMITY_RESTART="Restart",ENMITY_CHANGE_RESTART="Restart Required",ENMITY_CHANGE_RESTART_DESC="A restart is required to apply this change, would you like to restart?",enUS={ENMITY_GENERAL:ENMITY_GENERAL,ENMITY_PLUGINS:ENMITY_PLUGINS,ENMITY_THEMES:ENMITY_THEMES,ENMITY_UPDATER:ENMITY_UPDATER,ENMITY_DEBUG_LOGS:ENMITY_DEBUG_LOGS,ENMITY_SEARCH_PLUGINS:ENMITY_SEARCH_PLUGINS,ENMITY_SEARCH_THEMES:ENMITY_SEARCH_THEMES,ENMITY_SEARCH_ASSETS:ENMITY_SEARCH_ASSETS,ENMITY_DEVELOPMENT_SETTINGS:ENMITY_DEVELOPMENT_SETTINGS,ENMITY_DEBUG_BRIDGE_IP:ENMITY_DEBUG_BRIDGE_IP,ENMITY_DEBUG_BRIDGE_CONNECT:ENMITY_DEBUG_BRIDGE_CONNECT,ENMITY_DEBUG_BRIDGE:ENMITY_DEBUG_BRIDGE,ENMITY_TOAST_SETTINGS:ENMITY_TOAST_SETTINGS,ENMITY_ASSET_BROWSER:ENMITY_ASSET_BROWSER,ENMITY_ADDON_NO_DESCRIPTION:ENMITY_ADDON_NO_DESCRIPTION,ENMITY_ADDON_FAILED:ENMITY_ADDON_FAILED,ENMITY_INSTALL:ENMITY_INSTALL,ENMITY_INSTALL_TITLE:ENMITY_INSTALL_TITLE,ENMITY_THEME_EDITOR:ENMITY_THEME_EDITOR,ENMITY_THEME_GET_DESC:ENMITY_THEME_GET_DESC,ENMITY_THEME_GET_OPTION_CREATE:ENMITY_THEME_GET_OPTION_CREATE,ENMITY_THEME_GET_OPTION_IMPORT:ENMITY_THEME_GET_OPTION_IMPORT,ENMITY_RESTART:ENMITY_RESTART,ENMITY_CHANGE_RESTART:ENMITY_CHANGE_RESTART,ENMITY_CHANGE_RESTART_DESC:ENMITY_CHANGE_RESTART_DESC},enGB={},Strings={"en-US":enUS,"en-GB":enGB};function asyncGeneratorStep$1(t,r,n,l,u,f,d){try{var h=t[f](d),g=h.value}catch(t){n(t);return}h.done?r(g):Promise.resolve(g).then(l,u)}function _async_to_generator$1(t){return function(){var r=this,n=arguments;return new Promise(function(l,u){var f=t.apply(r,n);function d(t){asyncGeneratorStep$1(f,l,u,d,h,"next",t)}function h(t){asyncGeneratorStep$1(f,l,u,d,h,"throw",t)}d(void 0)})}}var state={locale:"en-US",messages:{}};function add(t){if("object"!=typeof t||Array.isArray(t))throw Error("Locale strings must be an object with languages and strings.");for(var r in t)addStrings(r,t[r]);return{remove:()=>{var r=i18n$1._provider._context;for(var n in t)for(var l of Object.keys(t[n]))delete r.defaultMessages[l],delete r.messages[l],delete i18n$1.Messages[l]}}}function addStrings(t,r){state.locale&&(state.messages[t]??={},Object.assign(state.messages[t],r),i18n$1.loadPromise.then(inject))}function inject(){if(state.locale&&i18n$1?.getLocale){var t=i18n$1._provider._context;Object.assign(t.messages,state.messages[state.locale]??{}),Object.assign(t.defaultMessages,state.messages["en-US"]??{})}}function onChange(t){return _onChange.apply(this,arguments)}function _onChange(){return(_onChange=_async_to_generator$1(function*(t){state.locale=t,yield i18n$1.loadPromise,inject()})).apply(this,arguments)}i18n$1?.getLocale&&(state.locale=i18n$1.getLocale()??"en-US",i18n$1.on("locale",onChange),add(Strings));var i18n=Object.freeze({__proto__:null,add:add,state:state}),metro=Object.assign(Modules,{components:Components,filters:Filters,actions:Actions,common:Common,stores:Stores,api:API$1,ui:UI}),API=Object.freeze({__proto__:null,assets:assets$1,components:components,i18n:i18n,managers:managers,metro:metro,native:native,patcher:patcher,storage:storage,toasts:toasts,utilities:utilities});function Addons({addons:t,type:r,shouldRestart:n}){var[l,u]=React$1.useState(""),f=l?[]:t;if(l)for(var d of t)(d.data.name.toLowerCase().includes(l)||d.data.description.toLowerCase().includes(l)||d.data.authors.some(t=>t.name.includes(l)))&&f.push(d);return React$1.createElement(ReactNative$1.SafeAreaView,{style:{flex:1}},React$1.createElement(ReactNative$1.View,{style:{flex:1}},React$1.createElement(Search,{placeholder:i18n$1.Messages[`ENMITY_SEARCH_${r.toUpperCase()}`],onChangeText:t=>u(t),onClear:()=>u(""),value:l}),React$1.createElement(ReactNative$1.FlatList,{data:f,renderItem:t=>React$1.createElement(_class$1,{shouldRestart:n,manager:managers[r],addon:t.item}),keyExtractor:(t,r)=>String(r)})))}var Plugins=()=>{var t=Navigation.useNavigation(),r=Plugins$2.useEntities();return React$1.useEffect(()=>{t.setOptions({headerRight:()=>React$1.createElement(HeaderRight,null)})},[]),React$1.createElement(ReactNative$1.View,{style:{flex:1}},React$1.createElement(Addons,{type:"plugins",addons:r}))};function HeaderRight(){var t=React$1.useRef(),r=React$1.useCallback(()=>t.current?.getInput(),[t.current]);return React$1.createElement(ReactNative$1.TouchableOpacity,{style:{marginRight:20},onPress:()=>{Dialog.confirm({title:i18n$1.Messages.ENMITY_INSTALL_TITLE.format({type:"plugin"}),children:React$1.createElement(InstallModal,{manager:Plugins$2,ref:t}),confirmText:i18n$1.Messages.ENMITY_INSTALL,onConfirm:()=>r()&&Plugins$2.install(r())})}},React$1.createElement(ReactNative$1.Image,{source:Icons.ic_add_circle}))}function _assert_this_initialized(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _class_call_check(t,r){if(!(t instanceof r))throw TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var n=0;n<r.length;n++){var l=r[n];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function _create_class(t,r,n){return r&&_defineProperties(t.prototype,r),n&&_defineProperties(t,n),t}function _define_property(t,r,n){return r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function _get_prototype_of(t){return(_get_prototype_of=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,r){if("function"!=typeof r&&null!==r)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_set_prototype_of(t,r)}function _possible_constructor_return(t,r){return r&&("object"===_type_of(r)||"function"==typeof r)?r:_assert_this_initialized(t)}function _set_prototype_of(t,r){return(_set_prototype_of=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function _type_of(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function _is_native_reflect_construct(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _create_super(t){var r=_is_native_reflect_construct();return function(){var n,l=_get_prototype_of(t);if(r){var u=_get_prototype_of(this).constructor;n=Reflect.construct(l,arguments,u)}else n=l.apply(this,arguments);return _possible_constructor_return(this,n)}}var _class=function(t){_inherits(n,t);var r=_create_super(n);function n(){var t;return _class_call_check(this,n),t=r.apply(this,arguments),_define_property(_assert_this_initialized(t),"state",{error:null,errorInfo:null}),t}return _create_class(n,[{key:"render",value:function(){return this.state.error?React$1.createElement(ReactNative$1.ScrollView,null,React$1.createElement(ReactNative$1.Text,null,this.state.error),React$1.createElement(ReactNative$1.Text,{style:{marginTop:10}},this.state.errorInfo)):this.props.children}},{key:"componentDidCatch",value:function(t,r){this.setState({error:t.message,errorInfo:r.componentStack})}}]),n}(React$1.PureComponent),Themes=()=>{var t=Navigation.useNavigation(),r=Themes$3.useEntities();return React$1.useEffect(()=>{t.setOptions({headerRight:()=>React$1.createElement(Add,null)})},[]),React$1.createElement(_class,null,React$1.createElement(ReactNative$1.View,{style:{flex:1}},React$1.createElement(Addons,{shouldRestart:!0,type:"themes",addons:r})))};function Add(){var t=Navigation.useNavigation(),r=React$1.useRef();return React$1.createElement(ReactNative$1.TouchableOpacity,{style:{marginRight:20},onPress:()=>{Dialog.confirm({title:i18n$1.Messages.ENMITY_INSTALL_TITLE.format({type:"theme"}),confirmText:i18n$1.Messages.ENMITY_THEME_GET_OPTION_CREATE,cancelText:i18n$1.Messages.ENMITY_THEME_GET_OPTION_IMPORT,body:i18n$1.Messages.ENMITY_THEME_GET_DESC,onConfirm:()=>{t.push(Screens.Custom,{title:i18n$1.Messages.ENMITY_THEME_EDITOR,render:()=>React$1.createElement(ReactNative$1.Text,null,"hi")})},onCancel:()=>{Dialog.confirm({title:i18n$1.Messages.ENMITY_INSTALL_TITLE.format({type:"plugin"}),children:React$1.createElement(InstallModal,{manager:Themes$3,ref:r}),confirmText:i18n$1.Messages.ENMITY_INSTALL,onConfirm:()=>{alert(r?.current?.getInput())}})}})}},React$1.createElement(ReactNative$1.Image,{source:Icons.ic_add_circle}))}var Patcher=createPatcher("settings");function apply$2(){var[t,r]=findByName({params:["UserSettingsOverviewWrapper"],interop:!1},{params:["getScreens"],interop:!1},{bulk:!0}),n=Patcher.after(t,"default",(t,r,l)=>{var u=findInReactTree(l,t=>t.type?.name==="UserSettingsOverview");if(!u)return l;patchSettings(u),n()});Patcher.after(r,"default",(t,r,n)=>({...n,[Screens.General]:{key:Screens.General,title:"Enmity",render:General},[Screens.Plugins]:{key:Screens.Plugins,render:Plugins,get title(){return i18n$1.Messages.ENMITY_PLUGINS}},[Screens.Themes]:{key:Screens.Themes,render:Themes,get title(){return i18n$1.Messages.ENMITY_THEMES}},[Screens.Updater]:{key:Screens.Updater,render:()=>null,get title(){return i18n$1.Messages.ENMITY_UPDATER}},[Screens.Custom]:{key:Screens.Custom,title:"Page",render:({title:t,render:r,...n})=>{var l=Navigation.useNavigation();return React$1.useEffect(()=>{t&&l.setOptions({title:t})},[]),React$1.createElement(r,n)}}}))}function patchSettings(t){Patcher.after(t.type.prototype,"render",(t,r,n)=>{var{navigation:l}=t.props,{children:u}=n.props,f=u.findIndex(t=>t?.props?.title===i18n$1.Messages.PREMIUM_SETTINGS_GENERIC);u.splice(f,0,React$1.createElement(React$1.Fragment,null,React$1.createElement(Forms.FormSection,{key:"Enmity",title:"Enmity"},React$1.createElement(Forms.FormRow,{label:i18n$1.Messages.ENMITY_GENERAL,leading:React$1.createElement(Forms.FormRow.Icon,{source:{uri:"https://files.enmity.app/icon-64.png"}}),trailing:React$1.createElement(Forms.FormArrow,null),onPress:()=>l.push(Screens.General,{...t.props,...n.props})}),React$1.createElement(Forms.FormDivider,null),React$1.createElement(Forms.FormRow,{label:i18n$1.Messages.ENMITY_PLUGINS,leading:React$1.createElement(puzzle,{height:24,width:24}),trailing:React$1.createElement(Forms.FormArrow,null),onPress:()=>l.push(Screens.Plugins,{...t.props,...n.props})}),React$1.createElement(Forms.FormDivider,null),React$1.createElement(Forms.FormRow,{label:i18n$1.Messages.ENMITY_THEMES,leading:React$1.createElement(palette,{height:24,width:24}),trailing:React$1.createElement(Forms.FormArrow,null),onPress:()=>l.push(Screens.Themes,{...t.props,...n.props})}),React$1.createElement(Forms.FormDivider,null),React$1.createElement(Forms.FormRow,{label:i18n$1.Messages.ENMITY_UPDATER,leading:React$1.createElement(Forms.FormRow.Icon,{source:Icons.ic_download_24px}),trailing:React$1.createElement(Forms.FormArrow,null),onPress:()=>l.push(Screens.Updater,{...t.props,...n.props})}))));var d=u.find(t=>t?.props.title===i18n$1.Messages.SUPPORT),h=d?.props.children;h&&(d.props.children=h.filter(t=>t?.type?.name!=="UploadLogsButton"))})}function remove$2(){Patcher.unpatchAll()}var settings=Object.freeze({__proto__:null,apply:apply$2,remove:remove$2});!function(t){t[t.error=3]="error",t[t.info=1]="info",t[t.log=1]="log",t[t.warn=2]="warn",t[t.trace=0]="trace",t[t.debug=0]="debug"}(Levels||(Levels={}));var methods=["error","info","log","warn","trace","debug"];function apply$1(){var t=function(t){console[t].__ORIGINAL__=console[t],console[t]=(...n)=>{for(var l=[],u=0,f=n.length;f>u;u++)l.push("string"==typeof n[u]?n[u]:r.inspect?.(n[u])??n[u].toString());var d=l.join(" ");addLog({message:d,level:Levels[t]}),nativeLoggingHook(d,Levels[t]??Levels.info)}},r=findByProps("inspect",{lazy:!0});for(var n of methods)t(n)}function remove$1(){for(var t of methods){var r=console[t].__ORIGINAL__;r&&(console[t]=r)}}var console$1=Object.freeze({__proto__:null,get Levels(){return Levels},apply:apply$1,remove:remove$1}),Patches$1=Object.freeze({__proto__:null,Console:console$1,Settings:settings,ThemeFix:themeFix}),Logger=createLogger("Core","Patches");function apply(){for(var t in Patches$1){var r=Patches$1[t];try{r.apply?.()}catch(r){Logger.error(`Failed to apply ${t} patch:`,r.message)}}}function remove(){for(var t in Patches$1){var r=Patches$1[t];try{r.remove?.()}catch(r){Logger.error(`Failed to remove ${t} patch:`,r.message)}}}var Patches={apply,remove};function asyncGeneratorStep(t,r,n,l,u,f,d){try{var h=t[f](d),g=h.value}catch(t){n(t);return}h.done?r(g):Promise.resolve(g).then(l,u)}function _async_to_generator(t){return function(){var r=this,n=arguments;return new Promise(function(l,u){var f=t.apply(r,n);function d(t){asyncGeneratorStep(f,l,u,d,h,"next",t)}function h(t){asyncGeneratorStep(f,l,u,d,h,"throw",t)}d(void 0)})}}function initialize(){return _initialize.apply(this,arguments)}function _initialize(){return(_initialize=_async_to_generator(function*(){try{Patches.apply()}catch(t){alert("Failed to apply patches: "+t.message)}try{BuiltIns.initialize()}catch(t){alert("Failed to apply builtins: "+t.message)}return window.enmity=API,API})).apply(this,arguments)}function shutdown(){return _shutdown.apply(this,arguments)}function _shutdown(){return(_shutdown=_async_to_generator(function*(){var{patcher:t}=API;for(var r in t.unpatchAll(),managers){var n=managers[r];yield n.shutdown()}Patches.remove(),BuiltIns.shutdown(),delete window.enmity})).apply(this,arguments)}var index={initialize,shutdown},index$1=Object.freeze({__proto__:null,default:index,initialize:initialize,shutdown:shutdown});
