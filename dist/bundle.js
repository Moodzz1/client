try{var Type,ManagerType,ws,Levels,find$2=t=>Object.values(modules).find(n=>n?.publicModule.exports?.[t])?.publicModule?.exports;window.ReactNative=find$2("AppState"),window.React=find$2("createElement");try{Promise.resolve().then(function(){return index$1}).then(t=>t.initialize())}catch(e){alert("Enmity failed to initialize: "+e.message)}}catch(e){alert("Enmity failed to pre-initialize: "+e.message)}!function(t){t.Before="before",t.Instead="instead",t.After="after"}(Type||(Type={}));var patches=[];function before(t,n,l,u,f=!1){return patch(t,n,l,u,Type.Before,f)}function instead(t,n,l,u,f=!1){return patch(t,n,l,u,Type.Instead,f)}function after(t,n,l,u,f=!1){return patch(t,n,l,u,Type.After,f)}function createPatcher(t){return{getPatchesByCaller,before:(n,l,u,f=!1)=>before(t,n,l,u,f),instead:(n,l,u,f=!1)=>instead(t,n,l,u,f),after:(n,l,u,f=!1)=>after(t,n,l,u,f),unpatchAll:()=>unpatchAll(t)}}function getPatchesByCaller(t){if(!t)return[];var n=[];for(var l of patches)for(var u of[...l.patches.before,...l.patches.instead,...l.patches.after])t&&u.caller!==t||n.push(u);return n}function unpatchAll(t){var n=getPatchesByCaller(t);if(n.length)for(var l of n)l.unpatch()}function override(t){return function(){if(!t?.patches?.before.length&&!t?.patches?.after.length&&!t?.patches?.instead.length&&!patches.find(n=>n.mdl===t.mdl&&n.func===t.func))return t.unpatch(),new.target?new t.original(...arguments):t.original.apply(this,arguments);for(var n,l=arguments,u=[...t.patches.before],f=0;f<u.length;f++){var d=u[f];if(d)try{var h=d.callback(this,l,t.original.bind(this));Array.isArray(h)&&(l=h),d.once&&d.unpatch()}catch(n){console.error(`Could not fire before patch for ${t.func} of ${d.caller}`,n)}}var g=[...t.patches.instead];if(g.length)for(var y=0;y<g.length;y++){var $=g[y];if($)try{var E=$.callback(this,l,t.original.bind(this));void 0!==E&&(n=E),$.once&&$.unpatch()}catch(n){console.error(`Could not fire instead patch for ${t.func} of ${$.caller}`,n)}}else n=new.target?new t.original(...l):t.original.apply(this,l);for(var T=[...t.patches.after],R=0;R<T.length;R++){var S=T[R];if(S)try{var N=S.callback(this,l,n,t=>n=t);void 0!==N&&(n=N),S.once&&S.unpatch()}catch(n){console.error(`Could not fire after patch for ${t.func} of ${S.caller}`,n)}}return n}}function push(t,n){"renderPatched"===n&&(t[n]=function(...n){return new.target?new t(...n):t.apply(this,n)});var l={mdl:t,func:n,original:t[n],unpatch:()=>{"renderPatched"===l.func?delete l.mdl.renderPatched:l.mdl[l.func]=l.original,l.patches={before:[],after:[],instead:[]}},patches:{before:[],after:[],instead:[]}},u=override(l);t[n]=u;var f=Object.getOwnPropertyDescriptors(l.original);return delete f.length,Object.defineProperties(t[n],{...f,toString:{value:()=>l.original.toString(),configurable:!0,enumerable:!1},__ORIGINAL__:{value:l.original,configurable:!0,enumerable:!1}}),patches.push(l),l}function get$1(t,n){return patches.find(l=>l.mdl===t&&l.func===n)||push(t,n)}function patch(t,n,l,u,f=Type.After,d=!1){if(t&&"string"==typeof t){if(n&&["function","object"].includes(typeof n)){if(l&&"string"==typeof l){if(u&&"function"==typeof u){if(!f||"string"!=typeof f||!["after","before","instead"].includes(f))throw TypeError('fifth argument "type" must be of type string and any of the three: after, before, instead')}else throw TypeError('fourth argument "callback" must be of type function')}else throw TypeError('third argument "func" must be of type string')}else throw TypeError('second argument "mdl" must be of type function or object')}else throw TypeError('first argument "caller" must be of type string');var h=get$1(n,l),g={caller:t,once:d,type:f,id:h.patches?.[f]?.length??0,callback:u,unpatch:()=>{var t=h.patches?.[f].findIndex(t=>t.id===g.id);if(~t&&h.patches?.[f].splice(t,1),!h.patches?.before.length&&!h.patches?.after.length&&!h.patches?.instead.length){var u=patches.findIndex(t=>t.mdl==n&&t.func==l);u&&(patches[u]?.unpatch(),patches.splice(u,1))}}};return h.patches[f]??=[],h.patches[f].push(g),g.unpatch}var Patcher$5={createPatcher,before,instead,after,unpatchAll,patches},patcher=Object.freeze({__proto__:null,get Type(){return Type},after:after,before:before,createPatcher:createPatcher,default:Patcher$5,getPatchesByCaller:getPatchesByCaller,instead:instead,patches:patches,unpatchAll:unpatchAll});function log(...t){return console.log("\xbb",...t)}function error(...t){return console.error("\xbb",...t)}function success(...t){return console.log("\xbb",...t)}function warn(...t){return console.warn("\xbb",...t)}function debug$2(...t){return console.debug("\xbb",...t)}function info(...t){return console.info("\xbb",...t)}function createLogger(...t){var n=t.join(" â†’ ")+":";return{log:(...t)=>log(n,...t),error:(...t)=>error(n,...t),success:(...t)=>success(n,...t),warn:(...t)=>warn(n,...t),debug:(...t)=>debug$2(n,...t),info:(...t)=>info(n,...t)}}var Patcher$4=createPatcher("components"),Logger$6=createLogger("Components"),unknown=new Set,named=new Map;function traverse(t){if(t?.type&&"string"!=typeof t.type){var n=t.type;n.displayName?add$1(n.displayName,n):n.name?add$1(n.name,n):n.type?.name?add$1(n.type.name,n):n.type?.displayName?add$1(n.type.displayName,n):n.render?.displayName?add$1(n.render.displayName,n):n.render?.name?add$1(n.render.name,n):unknown.add(n);var{children:l}=t.props||{};for(var u of l?Array.isArray(l)?l:[l]:[])traverse(u)}}try{Patcher$4.before(window.React,"createElement",(t,n)=>{var[l]=n;return l&&traverse(l),"function"==typeof l&&void 0!==l.renderPatched&&(n[0]=l.renderPatched),n}),Patcher$4.after(React,"createElement",(t,n,l)=>{l&&traverse(l)})}catch(e){Logger$6.error("Failed to intercept React.createElement:",e.message)}function add$1(t,n){named.get(t)||named.set(t,n)}function getAll(){return{named:Object.fromEntries(named.entries()),unknown:[...unknown.values()]}}function getByName$1(t){return named.get(t)}var components=Object.freeze({__proto__:null,add:add$1,getAll:getAll,getByName:getByName$1});function _assert_this_initialized$6(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _class_call_check$7(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")}function _defineProperties$7(t,n){for(var l=0;l<n.length;l++){var u=n[l];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(t,u.key,u)}}function _create_class$7(t,n,l){return n&&_defineProperties$7(t.prototype,n),l&&_defineProperties$7(t,l),t}function _get_prototype_of$6(t){return(_get_prototype_of$6=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits$6(t,n){if("function"!=typeof n&&null!==n)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&_set_prototype_of$6(t,n)}function _possible_constructor_return$6(t,n){return n&&("object"===_type_of$7(n)||"function"==typeof n)?n:_assert_this_initialized$6(t)}function _set_prototype_of$6(t,n){return(_set_prototype_of$6=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function _type_of$7(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function _is_native_reflect_construct$6(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _create_super$6(t){var n=_is_native_reflect_construct$6();return function(){var l,u=_get_prototype_of$6(t);if(n){var f=_get_prototype_of$6(this).constructor;l=Reflect.construct(u,arguments,f)}else l=u.apply(this,arguments);return _possible_constructor_return$6(this,l)}}var ErrorBoundary=function(t){_inherits$6(l,t);var n=_create_super$6(l);function l(){return _class_call_check$7(this,l),n.apply(this,arguments)}return _create_class$7(l,[{key:"render",value:function(){var{state:t}=this.props;return t?.error?React.createElement(ReactNative.ScrollView,{style:{backgroundColor:"white",color:"black"}},React.createElement(ReactNative.Text,null,t.error.message),React.createElement(ReactNative.Text,{style:{marginTop:10}},t.info.componentStack)):this.props.children}}]),l}(React.PureComponent);function _check_private_redeclaration(t,n){if(n.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function _class_apply_descriptor_get(t,n){return n.get?n.get.call(t):n.value}function _class_call_check$6(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")}function _class_extract_field_descriptor(t,n,l){if(!n.has(t))throw TypeError("attempted to "+l+" private field on non-instance");return n.get(t)}function _class_private_field_get(t,n){var l=_class_extract_field_descriptor(t,n,"get");return _class_apply_descriptor_get(t,l)}function _class_private_field_init(t,n,l){_check_private_redeclaration(t,n),n.set(t,l)}function _defineProperties$6(t,n){for(var l=0;l<n.length;l++){var u=n[l];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(t,u.key,u)}}function _create_class$6(t,n,l){return n&&_defineProperties$6(t.prototype,n),l&&_defineProperties$6(t,l),t}var _listeners=new WeakMap,EventEmitter=function(){function t(){_class_call_check$6(this,t),_class_private_field_init(this,_listeners,{writable:!0,value:{}})}return _create_class$6(t,[{key:"emit",value:function(t,n=null){if(_class_private_field_get(this,_listeners)[t])for(var l of _class_private_field_get(this,_listeners)[t])try{l(n)}catch(n){console.error(`Failed to fire event listener for ${t}:`,n.message)}}},{key:"on",value:function(t,n){this.addListener(t,n)}},{key:"off",value:function(t,n){this.removeListener(t,n)}},{key:"addListener",value:function(t,n){_class_private_field_get(this,_listeners)[t]??=new Set,_class_private_field_get(this,_listeners)[t].add(n)}},{key:"removeListener",value:function(t,n){_class_private_field_get(this,_listeners)[t]&&(_class_private_field_get(this,_listeners)[t].delete(n),_class_private_field_get(this,_listeners)[t].size||delete _class_private_field_get(this,_listeners)[t])}}]),t}();function findInTree(t={},n=t=>t,{ignore:l=[],walkable:u=[],maxProperties:f=100}={}){for(var d=[t],h=function(...t){try{return Reflect.apply(n,this,t)}catch{return!1}};d.length&&f;){var g=d.shift();if(h(g))return g;if(Array.isArray(g))d.push(...g);else if("object"==typeof g&&null!==g){if(u.length)for(var y in g){var $=g[y];~u.indexOf(y)&&!~l.indexOf(y)&&d.push($)}else for(var E in g){var T=g[E];g&&~l.indexOf(E)||d.push(T)}}f--}}function findInReactTree(t,n=t=>t,l={}){return findInTree(t,n,{walkable:["props","children"],...l})}var overrides={useMemo:t=>t(),useState:t=>[t,()=>void 0],useReducer:t=>[t,()=>void 0],useEffect:()=>{},useLayoutEffect:()=>{},useRef:()=>({current:null}),useCallback:t=>t,useImperativeHandle:()=>{},useContext:t=>t._currentValue},keys=Object.keys(overrides);function forceRender(t){return(...n)=>{var l=window.React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher.current,u=keys.map(t=>[t,l[t]]);Object.assign(l,overrides);var f={rendered:null,error:null};try{f.rendered=t(...n)}catch(t){f.error=t}if(Object.assign(l,Object.fromEntries(u)),f.error)throw f.error;return f.rendered}}function capitalize(t){if("string"!=typeof t)throw TypeError("capitalize's first argument must be of type string");return t.charAt(0).toUpperCase()+t.slice(1)}function debounce(t,n){var l;return function(...u){clearTimeout(l),l=setTimeout(()=>t.apply(this,u),n)}}var Colors={red:"\x1b[31m",reset:"\x1b[0m",green:"\x1b[32m",gray:"\x1b[90m",blue:"\x1b[34m",yellow:"\x1b[33m"};function colorize(t,n="reset"){return Colors[n.toLowerCase()]+t+Colors.reset}function attempt(t){try{t()}catch{}}function isEmpty(t){for(var n in t)return!1;return!0}function noop(...t){}function uuid(t=30){var n="";do{var l=16*Math.random()|0;n+=(12==n.length?4:16==n.length?3&l|8:l).toString(16)}while(n.length<t);return n}var{DCDFileManager:DCDFileManager$1}=ReactNative.NativeModules,Events=new EventEmitter,settings$2=globalThis.ENMITY_SETTINGS??{},on=Events.on.bind(Events),off=Events.off.bind(Events);function get(t,n,l){return settings$2[t]?.[n]??l}function set(t,n,l){settings$2[t]??={},settings$2[t][n]=l,Events.emit("changed",{store:t,key:n,value:l}),Events.emit("set",{store:t,key:n,value:l})}function toggle(t,n,l){settings$2[t]??={};var u=settings$2[t][n]??l;settings$2[t][n]=!u,Events.emit("changed",{store:t,key:n,value:!u}),Events.emit("toggled",{store:t,key:n,prev:u,value:!u})}function remove$4(t,n){delete settings$2[t][n],isEmpty(settings$2[t])&&delete settings$2[t],Events.emit("changed",{store:t,key:n,value:void 0}),Events.emit("removed",{store:t,key:n})}function getStore(t){return{set:(n,l)=>set(t,n,l),get:(n,l)=>get(t,n,l),toggle:(n,l)=>toggle(t,n,l),remove:n=>remove$4(t,n),useSettingsStore:()=>useSettingsStore(t)}}function useSettingsStore(t){var[,n]=React.useState({});return React.useEffect(()=>{function l(l){l.store===t&&n({})}return Events.on("changed",l),()=>void Events.off("changed",l)},[]),getStore(t)}Events.on("changed",debounce(()=>{var t=JSON.stringify(settings$2),n="Enmity/settings.json";DCDFileManager$1.writeFile("documents",n,t,"utf8")},250));var Storage={useSettingsStore,getStore,get,set,remove:remove$4,on,off},storage=Object.freeze({__proto__:null,default:Storage,get:get,getStore:getStore,off:off,on:on,remove:remove$4,set:set,settings:settings$2,toggle:toggle,useSettingsStore:useSettingsStore}),Invite="enmity",Links={GitHub:"https://github.com/enmity-mod",Twitter:"https://twitter.com/EnmityApp"},Screens={General:"ENMITY_GENERAL",Plugins:"ENMITY_PLUGINS",Themes:"ENMITY_THEMES",Updater:"ENMITY_UPDATER",Custom:"CUSTOM"},Regex={SemanticVersioning:/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/i,URL:/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/i};function _assert_this_initialized$5(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function asyncGeneratorStep$3(t,n,l,u,f,d,h){try{var g=t[d](h),y=g.value}catch(t){l(t);return}g.done?n(y):Promise.resolve(y).then(u,f)}function _async_to_generator$3(t){return function(){var n=this,l=arguments;return new Promise(function(u,f){var d=t.apply(n,l);function h(t){asyncGeneratorStep$3(d,u,f,h,g,"next",t)}function g(t){asyncGeneratorStep$3(d,u,f,h,g,"throw",t)}h(void 0)})}}function _class_call_check$5(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")}function _defineProperties$5(t,n){for(var l=0;l<n.length;l++){var u=n[l];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(t,u.key,u)}}function _create_class$5(t,n,l){return n&&_defineProperties$5(t.prototype,n),l&&_defineProperties$5(t,l),t}function _define_property$4(t,n,l){return n in t?Object.defineProperty(t,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[n]=l,t}function _get_prototype_of$5(t){return(_get_prototype_of$5=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits$5(t,n){if("function"!=typeof n&&null!==n)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&_set_prototype_of$5(t,n)}function _possible_constructor_return$5(t,n){return n&&("object"===_type_of$6(n)||"function"==typeof n)?n:_assert_this_initialized$5(t)}function _set_prototype_of$5(t,n){return(_set_prototype_of$5=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function _type_of$6(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function _is_native_reflect_construct$5(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _create_super$5(t){var n=_is_native_reflect_construct$5();return function(){var l,u=_get_prototype_of$5(t);if(n){var f=_get_prototype_of$5(this).constructor;l=Reflect.construct(u,arguments,f)}else l=u.apply(this,arguments);return _possible_constructor_return$5(this,l)}}var{DCDFileManager}=ReactNative.NativeModules;!function(t){t.Plugins="plugin",t.Themes="theme"}(ManagerType||(ManagerType={}));var Manager=function(EventEmitter1){_inherits$5(Manager1,EventEmitter1);var _super=_create_super$5(Manager1);function Manager1(t){var n;return _class_call_check$5(this,Manager1),_define_property$4(_assert_this_initialized$5(n=_super.call(this)),"logger",void 0),_define_property$4(_assert_this_initialized$5(n),"settings",void 0),_define_property$4(_assert_this_initialized$5(n),"id",void 0),_define_property$4(_assert_this_initialized$5(n),"entities",new Map),_define_property$4(_assert_this_initialized$5(n),"started",new Set),_define_property$4(_assert_this_initialized$5(n),"errors",new Map),_define_property$4(_assert_this_initialized$5(n),"type",void 0),_define_property$4(_assert_this_initialized$5(n),"extension",void 0),_define_property$4(_assert_this_initialized$5(n),"path",void 0),_define_property$4(_assert_this_initialized$5(n),"name",void 0),n.type=t,n.name=capitalize(t)+"s",n.logger=createLogger("Manager",n.name),n.settings=getStore(`${t}-states`),n.path=`Enmity/${n.name}`,n}return _create_class$5(Manager1,[{key:"install",value:function(t){var n=this;return _async_to_generator$3(function*(){n.logger.debug(`Fetching ${t} for manifest...`);var l=yield fetch(t,{cache:"no-cache"}).then(t=>t.json());try{n.logger.debug("Validating manifest..."),n.validateManifest(l)}catch(t){return n.logger.debug("Failed to validate manifest:",t.message)}n.logger.debug(`Fetching bundle from ${l.bundle}...`);var u=yield fetch(l.bundle,{cache:"no-cache"}).then(t=>t.text());n.logger.debug("Done fetching..."),n.logger.debug("Saving..."),n.save(u,l),n.logger.debug("Loading..."),n.load(u,l)})()}},{key:"save",value:function(t,n){DCDFileManager.writeFile("documents",`${this.path}/${n.name}/bundle.${this.extension}`,t,"utf8"),DCDFileManager.writeFile("documents",`${this.path}/${n.name}/manifest.json`,JSON.stringify(n,null,2),"utf8")}},{key:"load",value:function(t,n){var l={failed:!1,instance:null};try{this.validateManifest(n);var u=this.handleBundle(t);u||this.handleInvalidBundle(),l.instance=u,(this.errors.has(n.id)||this.errors.has(n.path))&&(this.errors.delete(n.id),this.errors.delete(n.path))}catch(t){l.failed=!0,this.logger.error(`Failed to execute ${n.id}:`,t.message),this.errors.set(n.id??n.path,t)}var f={data:n,instance:l.instance,id:n.id,failed:l.failed,started:!1};this.entities.set(n.id,f),this.settings.get(n.id,!1)&&this.start(f),this.emit("updated")}},{key:"delete",value:function(t){var n=this.resolve(t);if(n)try{this.unload(n),DCDFileManager.writeFile("documents",`${this.path}/${n.data.name}/.delete`,"","utf8")}catch(t){this.logger.error(`Failed to delete ${n.data.id}:`,t.message)}}},{key:"start",value:function(t){var n=this.resolve(t);if(n)try{n.instance.start?.(),n.started=!0}catch(t){this.logger.error(`Failed to start ${n.data.id}:`,t.message),n.started=!1}}},{key:"stop",value:function(t){var n=this.resolve(t);if(n)try{n.instance.stop?.(),n.started=!1}catch(t){this.logger.error(`Failed to stop ${n.data.id}:`,t.message),n.started=!0}}},{key:"toggle",value:function(t){var n=this.resolve(t);if(n){var l=this.isEnabled(n.id);l?this.disable(n):this.enable(n),this.emit("toggle")}}},{key:"enable",value:function(t){var n=this.resolve(t);if(n)try{this.settings.set(n.id,!0),n.started||this.start(n)}catch(t){this.logger.error(`Failed to enable ${n.data.id}:`,t.message)}}},{key:"disable",value:function(t){var n=this.resolve(t);if(n)try{this.settings.set(n.id,!1),n.started&&this.stop(n)}catch(t){this.logger.error(`Failed to stop ${n.data.id}:`,t.message)}}},{key:"isEnabled",value:function(t){return!this.errors.has(t)&&this.settings.get(t,!1)}},{key:"unload",value:function(t){var n=this.resolve(t);if(n)try{n.started&&this.stop(n),this.entities.delete(n.id),this.emit("updated")}catch(t){this.logger.error(`FATAL: ${n.id} was not able to unload properly, a full app restart is recommended.`,t)}}},{key:"shutdown",value:function(){for(var t of this.addons)try{this.unload(t)}catch(n){this.logger.error(`Failed to stop ${t.id}. Skipping.`,n.message);continue}}},{key:"validateManifest",value:function(t){if(t.name&&"string"==typeof t.name){if(t.description&&"string"==typeof t.description){if(t.authors&&("object"==typeof t.name||Array.isArray(t.authors))){if(t.version&&"string"==typeof t.version&&Regex.SemanticVersioning.test(t.version)){if(!t.id||"string"!=typeof t.id)throw Error('Manifest property "id" must be of type string and match a "eternal.enmity" pattern.')}else throw Error('Manifest property "version" must be of type string and match the semantic versioning pattern.')}else throw Error('Manifest property "authors" must be of type array.')}else throw Error('Manifest property "description" must be of type string.')}else throw Error('Manifest property "name" must be of type string.')}},{key:"handleBundle",value:function handleBundle(bundle){var iife=eval(`() => { return ${bundle} }`),payload=iife(),res="function"==typeof payload?payload():payload;return res.default??res}},{key:"handleInvalidBundle",value:function(){throw Error("Bundle didn't return an instance.")}},{key:"resolve",value:function(t){if(t.data)return t;var n=this.entities.get(t);if(n)return n;var l=[...this.entities.values()].find(n=>n.data.name===t);if(l)return l}},{key:"useEntities",value:function(){var[,t]=React.useState({});return React.useEffect(()=>{function n(){t({})}return this.on("updated",n),this.on("toggle",n),()=>{this.off("updated",n),this.off("toggle",n)}},[]),this.addons}},{key:"addons",get:function(){return[...this.entities.values()]}}]),Manager1}(EventEmitter);function _assert_this_initialized$4(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _class_call_check$4(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")}function _defineProperties$4(t,n){for(var l=0;l<n.length;l++){var u=n[l];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(t,u.key,u)}}function _create_class$4(t,n,l){return n&&_defineProperties$4(t.prototype,n),l&&_defineProperties$4(t,l),t}function _define_property$3(t,n,l){return n in t?Object.defineProperty(t,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[n]=l,t}function _get_prototype_of$4(t){return(_get_prototype_of$4=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits$4(t,n){if("function"!=typeof n&&null!==n)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&_set_prototype_of$4(t,n)}function _possible_constructor_return$4(t,n){return n&&("object"===_type_of$5(n)||"function"==typeof n)?n:_assert_this_initialized$4(t)}function _set_prototype_of$4(t,n){return(_set_prototype_of$4=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function _type_of$5(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function _is_native_reflect_construct$4(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _create_super$4(t){var n=_is_native_reflect_construct$4();return function(){var l,u=_get_prototype_of$4(t);if(n){var f=_get_prototype_of$4(this).constructor;l=Reflect.construct(u,arguments,f)}else l=u.apply(this,arguments);return _possible_constructor_return$4(this,l)}}var Themes$2=function(t){_inherits$4(l,t);var n=_create_super$4(l);function l(){var t;return _class_call_check$4(this,l),_define_property$3(_assert_this_initialized$4(t=n.call(this,ManagerType.Themes)),"original",void 0),_define_property$3(_assert_this_initialized$4(t),"extension","json"),_define_property$3(_assert_this_initialized$4(t),"module",void 0),t}return _create_class$4(l,[{key:"initialize",value:function(t){for(var n of(this.module=t,window.ENMITY_THEMES??[])){var{manifest:l,bundle:u}=n;this.load(u,l)}}},{key:"start",value:function(t){var n=this.resolve(t);if(n&&!n.failed&&this.isEnabled(n.id)){try{if(n.instance.raw)for(var[l,u]of(n.instance.raw.PRIMARY_660||(n.instance.raw.PRIMARY_660=n.instance?.semantic?.BACKGROUND_PRIMARY[0]),Object.entries(n.instance.raw)))this.module.RawColor[l]=u,this.module.default.unsafe_rawColors[l]=u;if(n.instance.semantic){var f=this.module.default.meta.resolveSemanticColor;this.module.default.meta.resolveSemanticColor=function(t,l){var u=l[Object.getOwnPropertySymbols(l)[0]];if(n.instance.semantic[u]){var d={dark:0,light:1,amoled:2}[t.toLowerCase()]||0,h=n.instance.semantic[u][d];if(h)return h}return f.call(this,t,l)}}}catch(t){this.logger.error("Failed to apply theme:",t.message)}this.emit("applied",n),this.logger.log(`${n.id} started.`)}}},{key:"toggle",value:function(t){var n=this.resolve(t);if(n){var l=this.isEnabled(n.id);l?this.disable(n):this.enable(n),this.emit("toggle")}}},{key:"enable",value:function(t){var n=this.resolve(t);if(n)try{this.settings.set("applied",n.id),n.started||this.start(n)}catch(t){this.logger.error(`Failed to enable ${n.data.id}:`,t.message)}}},{key:"disable",value:function(t){var n=this.resolve(t);if(n)try{this.settings.set("applied",null),n.started&&this.stop(n)}catch(t){this.logger.error(`Failed to stop ${n.data.id}:`,t.message)}}},{key:"isEnabled",value:function(t){return this.settings.get("applied",null)===t}},{key:"handleBundle",value:function(t){return"object"==typeof t?t:JSON.parse(t)}}]),l}(Manager),Themes$3=new Themes$2;function byProps(...t){return n=>{for(var l=0,u=t.length;l<u;l++)if(void 0===n[t[l]])return!1;return!0}}function byPrototypes(...t){return n=>{if(!n.prototype)return!1;for(var l=0,u=t.length;l<u;l++)if(void 0===n.prototype[t[l]])return!1;return!0}}function byDisplayName(t){return n=>n.displayName===t}function byName(t){return n=>n.name===t}function byStore(t,n=!0){return l=>l._dispatcher&&l.getName?.()===(n?t+"Store":t)}var Filters={byProps,byDisplayName,byPrototypes,byName,byStore};function _type_of$4(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}var data$4={cache:[],patchedMoment:!1,patchedThemes:!1};function find$1(t,n={}){var l=function(t){if(!modules[t].isInitialized)try{__r(t)}catch{return deenumerate(t),"continue"}var n=modules[t].publicModule.exports;if(!n||n===window||null===n[Symbol()]||isEmpty(n))return deenumerate(t),"continue";if(!data$4.patchedMoment&&n.defineLocale){var l=n.defineLocale,d=n.locale();n.defineLocale=function(...t){try{l.apply(this,t),n.locale(d)}catch(t){console.error("Failed to define moment locale:",t.message)}},data$4.patchedMoment=!0}if(!data$4.patchedThemes&&n.SemanticColor){try{Themes$3.initialize(n)}catch(t){console.error("Failed to patch themes:",t.message)}data$4.patchedThemes=!0}if(E(n,t)){data$4.cache[t]=n;var h=y?modules[t]:n;if(!u)return{v:h};$.found.push(h)}if(g&&n.default&&E(n.default,t)){data$4.cache[t]=n;var T=y?modules[t]:f?n.default:n;if(!u)return{v:T};$.found.push(T)}};if(!t)throw Error("You must provide a filter to search by.");var{all:u=!1,interop:f=!0,cache:d=!0,initial:h=null,esModules:g=!0,raw:y=!1}=n,$={found:h??[],errored:!1},E=(n,l)=>{try{return t(n,l)}catch(t){if($.errored)return;$.errored=!0,console.error("Search filter threw an error, degrading performance.","This will create a bad experience for the user including lag spikes, a slow startup, etc.","Please fix this as soon as possible.","\n",t.stack)}},T=d?data$4.cache:modules;for(var R in T){var S=l(R);if("object"===_type_of$4(S))return S.v}return!d||u||$.found.length?d&&u?find$1(t,Object.assign(n,{cache:!1,initial:$.found})):u?$.found:null:find$1(t,Object.assign(n,{cache:!1}))}function bulk(...t){var n=Array(t.length);return find$1((l,u)=>{for(var f=0,d=t.length;f<d;f++){var h=t[f];h.filter&&(h.filter(l,u)&&(n[f]=l),l.default&&h.filter(l.default,u)&&(n[f]=h.interop??!0?l.default:l))}return n.filter(String).length===search.length},{interop:!1,esModules:!1}),n}function findByProps(...t){var[n,l]=parseOptions(t);return search(n,l,"byProps")}function findByPrototypes(...t){var[n,l]=parseOptions(t);return search(n,l,"byPrototypes")}function findStore(...t){var[[n],{short:l=!0,...u}]=parseOptions(t);return search([n,l],u,"byStore")}function findByName(...t){var[n,l]=parseOptions(t);return search(n,l,"byName")}function search(t,n,l){if(n.lazy){var u;return new Proxy({__METRO_LAZY__:!0,get module(){return u}},{get(f,d){if(d&&"string"==typeof d)return(u??=search(t,Object.assign(n,{lazy:!1}),l),"module"===d)?u:u?.[d]},set:(f,d,h)=>Object.defineProperty((u??=search(t,Object.assign(n,{lazy:!1}),l))??{},d,{value:h,writable:!0,configurable:!0})})}if("string"==typeof l&&(l=Filters[l]),l)return n.bulk?bulk(...t.map(t=>!Array.isArray(t)&&"object"==typeof t&&t.params?{filter:l(...t.params??[]),...t}:{filter:l(...t),interop:!0})):find$1(l(...t),n)}function parseOptions(t,n=t=>"object"==typeof t&&!Array.isArray(t),l={}){return[t,n(t[t.length-1])?t.pop():l]}function deenumerate(t){Object.defineProperty(modules,t,{value:modules[t],enumerable:!1,configurable:!0,writable:!0})}var Modules=Object.freeze({__proto__:null,bulk:bulk,find:find$1,findByName:findByName,findByProps:findByProps,findByPrototypes:findByPrototypes,findStore:findStore});createLogger("Debug","ErrorBoundary");var Patcher$3=createPatcher("error-boundary"),Boundary=findByName("ErrorBoundary"),data$3={id:"dev.errorBoundary",settings:["dev.errorBoundaryEnabled"],default:!0};function initialize$5(){Boundary&&Patcher$3.after(Boundary.prototype,"render",(t,n,l)=>React.createElement(ErrorBoundary,{state:t.state},l))}function shutdown$4(){}var errorBoundary=Object.freeze({__proto__:null,data:data$3,initialize:initialize$5,shutdown:shutdown$4}),Patcher$2=createPatcher("no-track"),data$2={id:"misc.anti-track",default:!0};function initialize$4(){var[t,n,l]=findByProps({params:["trackWithMetadata"]},{params:["AnalyticsActionHandlers"]},{params:["encodeProperties","track"]},{bulk:!0});attempt(()=>Patcher$2.instead(t,"trackWithMetadata",noop)),attempt(()=>Patcher$2.instead(n.AnalyticsActionHandlers,"handleConnectionClosed",noop)),attempt(()=>Patcher$2.instead(n.AnalyticsActionHandlers,"handleConnectionOpen",noop)),attempt(()=>Patcher$2.instead(n.AnalyticsActionHandlers,"handleFingerprint",noop)),attempt(()=>Patcher$2.instead(n.AnalyticsActionHandlers,"handleTrack",noop)),attempt(()=>Patcher$2.instead(l,"track",noop))}function shutdown$3(){Patcher$2.unpatchAll()}var antiTrack=Object.freeze({__proto__:null,data:data$2,initialize:initialize$4,shutdown:shutdown$3}),Flux=findByProps("Store","connectStores",{lazy:!0}),Moment=findByProps("isMoment"),ReactNative$1=window.ReactNative,React$1=window.React,Chroma=window.Chroma,StyleSheet=findByProps("createThemedStyleSheet",{lazy:!0}),Dispatcher=findByProps("_dispatch",{lazy:!0}),Constants=findByProps("API_HOST","Endpoints",{lazy:!0}),Theme$1=findByProps("colors","meta",{lazy:!0}),REST=findByProps("getAPIBaseURL",{lazy:!0}),i18n$1=findByProps("Messages",{lazy:!0}),Common=Object.freeze({__proto__:null,Chroma:Chroma,Constants:Constants,Dispatcher:Dispatcher,Flux:Flux,Moment:Moment,REST:REST,React:React$1,ReactNative:ReactNative$1,StyleSheet:StyleSheet,Theme:Theme$1,i18n:i18n$1}),Logger$5=createLogger("Debug","WebSocket"),data$1={id:"dev.debugBridge",settings:["dev.debugBridgeHost"],default:!1};function initialize$3(isReconnect=!1){var settings=getStore("enmity");try{ws=new WebSocket(`ws://${settings.get("dev.debugBridgeHost","192.168.0.35:9090")}`)}catch(e){alert("Failed to connect to the debug websocket. Make sure the host is reachable."),Logger$5.error(e.message)}ws?.addEventListener("open",()=>{Logger$5.success(isReconnect?"Reconnected.":"Connected.")}),ws?.addEventListener("message",message=>{try{Logger$5.log(eval(message.data))}catch(e){Logger$5.error(e)}}),globalThis._nativeLoggingHook=nativeLoggingHook,globalThis.nativeLoggingHook=function(t,n){return ws?.readyState===WebSocket.OPEN&&ws.send(JSON.stringify({level:n,message:t})),globalThis._nativeLoggingHook.apply(this,arguments)};var{remove}=ReactNative$1.AppState?.addEventListener("change",t=>{switch(t){case"active":if(ws||ws?.readyState===WebSocket.OPEN)return;remove(),initialize$3(!0);break;case"background":shutdown$2()}})}function shutdown$2(){globalThis._nativeLoggingHook&&(globalThis.nativeLoggingHook=globalThis._nativeLoggingHook),ws?.readyState===WebSocket.OPEN&&(ws.close(),ws=null)}var debug$1=Object.freeze({__proto__:null,data:data$1,initialize:initialize$3,shutdown:shutdown$2,get ws(){return ws}}),instances=Object.freeze({__proto__:null,AntiTrack:antiTrack,Debug:debug$1,ErrorBoundary:errorBoundary}),Logger$4=createLogger("Core","Built-Ins"),settings$1=Storage.getStore("enmity"),started=new Set;function initialize$2(){for(var t in instances){var n=instances[t];settings$1.get(n.data.id,n.data.default??!0)&&start(t)}}function shutdown$1(){for(var t of started)stop(t)}function start(t){if(instances[t]&&!started.has(t)){var n=instances[t];try{n.initialize?.(),started.add(t)}catch(n){started.delete(t),Logger$4.error(`Failed to initialize built-in ${t}:`,n.message)}}}function stop(t){if(instances[t]&&started.has(t)){var n=instances[t];try{n.shutdown?.(),started.delete(t)}catch(n){started.add(t),Logger$4.error(`Failed to shutdown built-in ${t}:`,n.message)}}}function onSettingsChange({store:t,key:n,value:l}){if("enmity"===t)for(var u in instances){var f=instances[u];f.data.id===n?(l?start:stop)(u):f.data.settings?.includes(n)&&started.has(u)&&(stop(u),start(u))}}Storage.on("changed",onSettingsChange);var BuiltIns={initialize:initialize$2,shutdown:shutdown$1,start,stop},Guilds=findStore("Guild",{lazy:!0}),Theme=findStore("Theme",{lazy:!0}),Users=findStore("User",{lazy:!0}),Stores=Object.freeze({__proto__:null,Guilds:Guilds,Theme:Theme,Users:Users}),Themes$1=findByProps("updateTheme","overrideTheme",{lazy:!0}),Dialog=findByProps("show","close","openLazy",{lazy:!0}),Profiles=findByProps("showUserProfile",{lazy:!0}),UI=Object.freeze({__proto__:null,Dialog:Dialog,Profiles:Profiles,Themes:Themes$1});function apply$3(){Dispatcher?.subscribe&&Dispatcher.subscribe("CONNECTION_OPEN",handler)}function remove$3(){Dispatcher?.subscribe&&Dispatcher.unsubscribe("CONNECTION_OPEN",handler)}function handler(){Themes$1.overrideTheme(Theme.theme)}var themeFix=Object.freeze({__proto__:null,apply:apply$3,remove:remove$3}),Native=findByProps("Button","View","Text",{lazy:!0}),Forms=findByProps("Form","FormSection",{lazy:!0}),SVG=findByProps("Svg","Path",{lazy:!0}),Search=findByName("StaticSearchBarContainer"),Media=findByProps("openMediaModal"),Navigation=findByProps("useNavigation",{lazy:!0}),Components=Object.freeze({__proto__:null,Forms:Forms,Media:Media,Native:Native,Navigation:Navigation,SVG:SVG,Search:Search}),assets=new Set,registry=findByProps("registerAsset");Patcher$5.after("enmity-assets",registry,"registerAsset",(t,[n],l)=>{Object.assign(n,{id:l}),assets.add(n)});for(var id=1;;id++){var asset=registry.getAssetByID(id);if(!asset)break;assets.has(asset)||(Object.assign(asset,{id}),assets.add(asset))}function find(t){return Object.values(assets).find(t)}function getByName(t,n="png"){return[...assets].find(l=>l.name===t&&l.type===n)}function getByID(t){return registry.getAssetByID(t)}function getIDByName(t,n="png"){return getByName(t,n)?.id}var Icons=new Proxy({},{get:(t,n)=>getIDByName(n)}),Assets$1={assets,getByName,getByID,getIDByName},assets$1=Object.freeze({__proto__:null,Icons:Icons,assets:assets,default:Assets$1,find:find,getByID:getByID,getByName:getByName,getIDByName:getIDByName,registry:registry}),{colors:colors$5}=Theme$1,styles$4=StyleSheet.createThemedStyleSheet({icon:{color:colors$5.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});function palette({height:t,width:n,color:l=styles$4.icon.color,...u}){return React$1.createElement(SVG.Svg,{viewBox:"0 0 24 24",style:{height:t,width:n,...styles$4.icon,color:l},fill:"currentColor",...u},React$1.createElement(SVG.Path,{d:"M0 0h24v24H0z",fill:"none"}),React$1.createElement(SVG.Path,{d:"M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"}))}var{colors:colors$4}=Theme$1,styles$3=StyleSheet.createThemedStyleSheet({icon:{color:colors$4.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});function puzzle({height:t,width:n,color:l=styles$3.icon.color,...u}){return React$1.createElement(SVG.Svg,{viewBox:"0 0 24 24",style:{height:t,width:n,...styles$3.icon,color:l},fill:"currentColor",...u},React$1.createElement(SVG.Path,{d:"M0 0h24v24H0z",fill:"none"}),React$1.createElement(SVG.Path,{d:"M20.5 11H19V7c0-1.1-.9-2-2-2h-4V3.5C13 2.12 11.88 1 10.5 1S8 2.12 8 3.5V5H4c-1.1 0-1.99.9-1.99 2v3.8H3.5c1.49 0 2.7 1.21 2.7 2.7s-1.21 2.7-2.7 2.7H2V20c0 1.1.9 2 2 2h3.8v-1.5c0-1.49 1.21-2.7 2.7-2.7 1.49 0 2.7 1.21 2.7 2.7V22H17c1.1 0 2-.9 2-2v-4h1.5c1.38 0 2.5-1.12 2.5-2.5S21.88 11 20.5 11z"}))}var Invites=findByProps("acceptInviteAndTransitionToInviteChannel",{lazy:!0}),Actions=Object.freeze({__proto__:null,Invites:Invites});function _assert_this_initialized$3(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _class_call_check$3(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")}function _defineProperties$3(t,n){for(var l=0;l<n.length;l++){var u=n[l];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(t,u.key,u)}}function _create_class$3(t,n,l){return n&&_defineProperties$3(t.prototype,n),l&&_defineProperties$3(t,l),t}function _define_property$2(t,n,l){return n in t?Object.defineProperty(t,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[n]=l,t}function _get_prototype_of$3(t){return(_get_prototype_of$3=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits$3(t,n){if("function"!=typeof n&&null!==n)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&_set_prototype_of$3(t,n)}function _possible_constructor_return$3(t,n){return n&&("object"===_type_of$3(n)||"function"==typeof n)?n:_assert_this_initialized$3(t)}function _set_prototype_of$3(t,n){return(_set_prototype_of$3=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function _type_of$3(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function _is_native_reflect_construct$3(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _create_super$3(t){var n=_is_native_reflect_construct$3();return function(){var l,u=_get_prototype_of$3(t);if(n){var f=_get_prototype_of$3(this).constructor;l=Reflect.construct(u,arguments,f)}else l=u.apply(this,arguments);return _possible_constructor_return$3(this,l)}}var Plugins$1=function(t){_inherits$3(l,t);var n=_create_super$3(l);function l(){var t;return _class_call_check$3(this,l),_define_property$2(_assert_this_initialized$3(t=n.call(this,ManagerType.Plugins)),"extension","js"),t.initialize(),t}return _create_class$3(l,[{key:"initialize",value:function(){for(var t of window.ENMITY_PLUGINS??[]){var{manifest:n,bundle:l}=t;this.load(l,n)}}}]),l}(Manager),Plugins$2=new Plugins$1;function _assert_this_initialized$2(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _class_call_check$2(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")}function _defineProperties$2(t,n){for(var l=0;l<n.length;l++){var u=n[l];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(t,u.key,u)}}function _create_class$2(t,n,l){return n&&_defineProperties$2(t.prototype,n),l&&_defineProperties$2(t,l),t}function _get_prototype_of$2(t){return(_get_prototype_of$2=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits$2(t,n){if("function"!=typeof n&&null!==n)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&_set_prototype_of$2(t,n)}function _possible_constructor_return$2(t,n){return n&&("object"===_type_of$2(n)||"function"==typeof n)?n:_assert_this_initialized$2(t)}function _set_prototype_of$2(t,n){return(_set_prototype_of$2=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function _type_of$2(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function _is_native_reflect_construct$2(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _create_super$2(t){var n=_is_native_reflect_construct$2();return function(){var l,u=_get_prototype_of$2(t);if(n){var f=_get_prototype_of$2(this).constructor;l=Reflect.construct(u,arguments,f)}else l=u.apply(this,arguments);return _possible_constructor_return$2(this,l)}}var{Fonts:Fonts$2}=Constants,{colors:colors$3}=Theme$1,styles$2=StyleSheet.createThemedStyleSheet({label:{fontFamily:Fonts$2.DISPLAY_SEMIBOLD,color:colors$3.TEXT_NORMAL,fontSize:16},image:{width:24,height:24}}),_class$1=function(t){_inherits$2(l,t);var n=_create_super$2(l);function l(){return _class_call_check$2(this,l),n.apply(this,arguments)}return _create_class$2(l,[{key:"render",value:function(){var{item:t}=this.props;return React$1.createElement(Forms.FormRow,{label:()=>React$1.createElement(ReactNative$1.Text,{style:styles$2.label},t.name),leading:()=>React$1.createElement(ReactNative$1.Image,{style:styles$2.image,source:t.id}),subLabel:t.type.toUpperCase(),onPress:this.open.bind(this)})}},{key:"open",value:function(){Media.openMediaModal}}]),l}(React$1.PureComponent);function AssetBrowser(){var[t,n]=React$1.useState(),l=[...assets.values()].filter(t=>"png"===t.type),u=t?[]:l;if(t)for(var f of l)(f.name.toLowerCase().includes(t)||f.httpServerLocation.toLowerCase().includes(t))&&u.push(f);return React$1.createElement(ReactNative$1.View,null,React$1.createElement(Search,{placeholder:i18n$1.Messages.ENMITY_SEARCH_ASSETS,onChangeText:t=>n(t),onClear:()=>n(""),value:t}),React$1.createElement(Forms.FormSection,{style:{flex:1}},React$1.createElement(ReactNative$1.FlatList,{keyExtractor:(t,n)=>String(n),data:u,ItemSeparatorComponent:Forms.FormDivider,renderItem:({item:t})=>React$1.createElement(_class$1,{item:t})})))}function createStore(t){var n=new Set,l=Object.freeze({getState:(n=t=>t)=>n(t),setState(l){var u="function"==typeof l?l(t):l;if(!Object.is(t,u))for(var f of(t=Object.assign({},t,u),n))try{f(t)}catch{console.error("Failed to fire listener in zustand store.")}},addListener(t){if(!n.has(t))return n.add(t),()=>n.delete(t)},removeListener:t=>n.delete(t),get listeners(){return n}});function u(t=t=>t){var[,u]=React$1.useReducer(t=>t+1,0);return React$1.useEffect(()=>{var t=()=>u();return n.add(t),()=>void n.delete(t)},[]),l.getState(t)}return Object.assign(u,l,{*[Symbol.iterator](){yield l,yield u}}),u}var[store,useStore]=createStore({logs:[]});function addLog({message:t,level:n}){store.setState(l=>({logs:[...l.logs,{time:Date.now(),message:t,level:n}]}))}var Logger$3={store,useStore},{Fonts:Fonts$1}=Constants,{colors:colors$2}=Theme$1;function Logs(){var t=Navigation.useNavigation(),n=Logger$3.useStore();return React$1.useEffect(()=>{t.setOptions({headerRight:HeaderRight$1})},[]),React$1.createElement(Forms.FormSection,{style:{flex:1}},React$1.createElement(ReactNative$1.FlatList,{data:n.logs.sort((t,n)=>t.time-n.time),keyExtractor:(t,n)=>String(n),ListEmptyComponent:()=>React$1.createElement(ReactNative$1.Text,null,"nothing here!"),ItemSeparatorComponent:Forms.FormDivider,renderItem:({item:t})=>{var n=StyleSheet.createThemedStyleSheet({log:{fontSize:16,fontFamily:Fonts$1.DISPLAY_SEMIBOLD,color:(()=>{switch(t.level){case 1:return colors$2.TEXT_NORMAL;case 0:return colors$2.TEXT_MUTED;case 2:return"yellow";case 3:return"red"}})()},time:{fontSize:16,fontFamily:Fonts$1.DISPLAY_SEMIBOLD,color:colors$2.TEXT_MUTED}});return React$1.createElement(Forms.FormRow,{label:()=>React$1.createElement(ReactNative$1.Text,{style:n.log},t.message),subLabel:Moment(t.time).format("HH:mm:ss.SSS")})}}))}var styles$1=StyleSheet.createThemedStyleSheet({touchable:{marginRight:10},image:{tintColor:colors$2.TEXT_NORMAL}});function HeaderRight$1(){return React$1.createElement(ReactNative$1.TouchableOpacity,{style:styles$1.touchable,onPress:()=>Logger$3.store.setState({logs:[]})},React$1.createElement(ReactNative$1.Image,{style:styles$1.image,source:Assets$1.getIDByName("ic_input_clear_24px")}))}function Developer(){var t=Navigation.useNavigation(),n=useSettingsStore("enmity"),l={Debug:Assets$1.getIDByName("debug")};return React$1.createElement(React$1.Fragment,null,React$1.createElement(Forms.FormSection,{title:i18n$1.Messages.ENMITY_DEBUG_BRIDGE},React$1.createElement(Forms.FormRow,{label:i18n$1.Messages.ENMITY_DEBUG_BRIDGE_CONNECT,trailing:React$1.createElement(Forms.FormSwitch,{value:n.get("dev.debugBridge",!1),onValueChange:()=>n.toggle("dev.debugBridge",!1)})}),n.get("dev.debugBridge",!1)&&React$1.createElement(React$1.Fragment,null,React$1.createElement(Forms.FormDivider,null),React$1.createElement(Forms.FormInput,{value:n.get("dev.debugBridgeHost","192.168.0.35:9090"),onChange:t=>n.set("dev.debugBridgeHost",t),title:i18n$1.Messages.ENMITY_DEBUG_BRIDGE_IP}))),React$1.createElement(Forms.FormSection,null,React$1.createElement(Forms.FormRow,{label:i18n$1.Messages.ENMITY_ASSET_BROWSER,leading:React$1.createElement(Forms.FormRow.Icon,{source:l.Debug}),trailing:Forms.FormRow.Arrow,onPress:()=>t.push(Screens.Custom,{title:i18n$1.Messages.ENMITY_ASSET_BROWSER,render:AssetBrowser})}),React$1.createElement(Forms.FormDivider,null),React$1.createElement(Forms.FormRow,{label:i18n$1.Messages.ENMITY_DEBUG_LOGS,leading:React$1.createElement(Forms.FormRow.Icon,{source:l.Debug}),trailing:Forms.FormRow.Arrow,onPress:()=>t.push(Screens.Custom,{title:i18n$1.Messages.ENMITY_DEBUG_LOGS,render:Logs})})))}var Toasts=()=>React$1.createElement(ReactNative$1.Text,null,"Placeholder."),{colors:colors$1}=Theme$1,styles=StyleSheet.createThemedStyleSheet({trailingText:{color:colors$1.TEXT_MUTED},container:{marginBottom:50}});function General(){var t=Navigation.useNavigation(),n={Twitter:Assets$1.getIDByName("img_account_sync_twitter_white"),GitHub:Assets$1.getIDByName("img_account_sync_github_white"),Development:Assets$1.getIDByName("ic_progress_wrench_24px"),Toasts:Assets$1.getIDByName("ic_notification_settings"),Discord:Assets$1.getIDByName("Discord")};return React$1.createElement(ReactNative$1.ScrollView,null,React$1.createElement(ReactNative$1.KeyboardAvoidingView,{enabled:!0,behavior:"position",style:styles.container,keyboardVerticalOffset:100,contentContainerStyle:{backfaceVisibility:"hidden"}},React$1.createElement(Forms.FormSection,null,React$1.createElement(Forms.FormRow,{label:i18n$1.Messages.ENMITY_TOAST_SETTINGS,leading:React$1.createElement(Forms.FormRow.Icon,{source:n.Toasts}),trailing:Forms.FormRow.Arrow,onPress:()=>t.push(Screens.Custom,{title:i18n$1.Messages.ENMITY_TOAST_SETTINGS,render:Toasts})}),React$1.createElement(Forms.FormDivider,null),React$1.createElement(Forms.FormRow,{label:i18n$1.Messages.ENMITY_DEVELOPMENT_SETTINGS,leading:React$1.createElement(Forms.FormRow.Icon,{source:n.Development}),trailing:Forms.FormRow.Arrow,onPress:()=>t.push(Screens.Custom,{title:i18n$1.Messages.ENMITY_DEVELOPMENT_SETTINGS,render:Developer})})),React$1.createElement(Forms.FormSection,{title:"Stats"},React$1.createElement(Forms.FormRow,{label:"Installed Plugins",leading:React$1.createElement(puzzle,{width:24,height:24}),trailing:()=>React$1.createElement(ReactNative$1.Text,{style:styles.trailingText},Plugins$2.addons.length)}),React$1.createElement(Forms.FormDivider,null),React$1.createElement(Forms.FormRow,{label:"Installed Themes",leading:React$1.createElement(palette,{width:24,height:24}),trailing:()=>React$1.createElement(ReactNative$1.Text,{style:styles.trailingText},Themes$3.addons.length)})),React$1.createElement(Forms.FormSection,{title:"Links"},React$1.createElement(Forms.FormRow,{label:"Discord Server",leading:React$1.createElement(Forms.FormRow.Icon,{source:n.Discord}),trailing:Forms.FormRow.Arrow,onPress:()=>Invites.acceptInviteAndTransitionToInviteChannel({inviteKey:Invite})}),React$1.createElement(Forms.FormDivider,null),React$1.createElement(Forms.FormRow,{label:"GitHub",leading:React$1.createElement(Forms.FormRow.Icon,{source:n.GitHub}),trailing:Forms.FormRow.Arrow,onPress:()=>ReactNative$1.Linking.openURL(Links.GitHub)}),React$1.createElement(Forms.FormDivider,null),React$1.createElement(Forms.FormRow,{label:"Twitter",leading:React$1.createElement(Forms.FormRow.Icon,{source:n.Twitter}),trailing:Forms.FormRow.Arrow,onPress:()=>ReactNative$1.Linking.openURL(Links.Twitter)}))))}function _assert_this_initialized$1(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _class_call_check$1(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")}function _defineProperties$1(t,n){for(var l=0;l<n.length;l++){var u=n[l];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(t,u.key,u)}}function _create_class$1(t,n,l){return n&&_defineProperties$1(t.prototype,n),l&&_defineProperties$1(t,l),t}function _define_property$1(t,n,l){return n in t?Object.defineProperty(t,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[n]=l,t}function _get_prototype_of$1(t){return(_get_prototype_of$1=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits$1(t,n){if("function"!=typeof n&&null!==n)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&_set_prototype_of$1(t,n)}function _possible_constructor_return$1(t,n){return n&&("object"===_type_of$1(n)||"function"==typeof n)?n:_assert_this_initialized$1(t)}function _set_prototype_of$1(t,n){return(_set_prototype_of$1=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function _type_of$1(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function _is_native_reflect_construct$1(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _create_super$1(t){var n=_is_native_reflect_construct$1();return function(){var l,u=_get_prototype_of$1(t);if(n){var f=_get_prototype_of$1(this).constructor;l=Reflect.construct(u,arguments,f)}else l=u.apply(this,arguments);return _possible_constructor_return$1(this,l)}}var InstallModal=function(t){_inherits$1(l,t);var n=_create_super$1(l);function l(){var t;return _class_call_check$1(this,l),t=n.apply(this,arguments),_define_property$1(_assert_this_initialized$1(t),"state",{url:""}),_define_property$1(_assert_this_initialized$1(t),"styles",StyleSheet.createThemedStyleSheet({input:{height:40,borderBottomWidth:2,marginTop:10,borderBottomColor:Theme$1.colors.CONTROL_BRAND_FOREGROUND_NEW??Theme$1.colors.CONTROL_BRAND_FOREGROUND,color:Theme$1.colors.TEXT_NORMAL}})),t}return _create_class$1(l,[{key:"render",value:function(){return React.createElement(React.Fragment,null,React.createElement(ReactNative$1.TextInput,{style:this.styles.input,onChangeText:t=>this.setState({url:t}),value:this.state.url,placeholder:"https://example.com/",autoFocus:!0}))}},{key:"getInput",value:function(){return this.state.url}}]),l}(React.PureComponent),AsyncUsers=findByProps("fetchProfile",{lazy:!0}),API$1=Object.freeze({__proto__:null,AsyncUsers:AsyncUsers}),{DCDDeviceManager,BundleUpdaterManager}=ReactNative$1.NativeModules,BundleInfo=ReactNative$1.NativeModules.InfoDictionaryManager??ReactNative$1.NativeModules.RTNClientInfoManager,BundleManager=BundleUpdaterManager,DeviceInfo=DCDDeviceManager,reload=()=>BundleUpdaterManager.reload();ReactNative$1.Linking.addListener("url",t=>{console.log(t)});var native=Object.freeze({__proto__:null,BundleInfo:BundleInfo,BundleManager:BundleManager,DeviceInfo:DeviceInfo,reload:reload});function _assert_this_initialized(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function asyncGeneratorStep$2(t,n,l,u,f,d,h){try{var g=t[d](h),y=g.value}catch(t){l(t);return}g.done?n(y):Promise.resolve(y).then(u,f)}function _async_to_generator$2(t){return function(){var n=this,l=arguments;return new Promise(function(u,f){var d=t.apply(n,l);function h(t){asyncGeneratorStep$2(d,u,f,h,g,"next",t)}function g(t){asyncGeneratorStep$2(d,u,f,h,g,"throw",t)}h(void 0)})}}function _class_call_check(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")}function _defineProperties(t,n){for(var l=0;l<n.length;l++){var u=n[l];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(t,u.key,u)}}function _create_class(t,n,l){return n&&_defineProperties(t.prototype,n),l&&_defineProperties(t,l),t}function _define_property(t,n,l){return n in t?Object.defineProperty(t,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[n]=l,t}function _get_prototype_of(t){return(_get_prototype_of=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,n){if("function"!=typeof n&&null!==n)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&_set_prototype_of(t,n)}function _possible_constructor_return(t,n){return n&&("object"===_type_of(n)||"function"==typeof n)?n:_assert_this_initialized(t)}function _set_prototype_of(t,n){return(_set_prototype_of=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function _type_of(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function _is_native_reflect_construct(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _create_super(t){var n=_is_native_reflect_construct();return function(){var l,u=_get_prototype_of(t);if(n){var f=_get_prototype_of(this).constructor;l=Reflect.construct(u,arguments,f)}else l=u.apply(this,arguments);return _possible_constructor_return(this,l)}}var{Fonts}=Constants,{colors}=Theme$1,_class=function(t){_inherits(l,t);var n=_create_super(l);function l(){var t;return _class_call_check(this,l),t=n.apply(this,arguments),_define_property(_assert_this_initialized(t),"styles",StyleSheet.createThemedStyleSheet({card:{backgroundColor:colors.BACKGROUND_SECONDARY,marginHorizontal:10,borderRadius:5,marginTop:10},failed:{opacity:.5},error:{color:"red",marginTop:10},header:{backgroundColor:colors.BACKGROUND_TERTIARY,borderTopRightRadius:5,borderTopLeftRadius:5,paddingHorizontal:15,flexDirection:"row",alignItems:"center",padding:10,flex:1},name:{color:colors.TEXT_NORMAL,fontFamily:Fonts.PRIMARY_BOLD,marginRight:2.5,fontSize:16},version:{fontFamily:Fonts.PRIMARY_SEMIBOLD,color:colors.TEXT_MUTED,marginRight:2.5,fontSize:14},by:{fontFamily:Fonts.PRIMARY_NORMAL,color:colors.TEXT_MUTED,marginRight:2.5,fontSize:14},authors:{fontFamily:Fonts.PRIMARY_SEMIBOLD,color:colors.TEXT_MUTED,fontSize:14,flex:1},authorContainer:{flexDirection:"row"},touchable:{color:colors.TEXT_NORMAL},info:{padding:15},description:{fontFamily:Fonts.PRIMARY_SEMIBOLD,color:colors.TEXT_NORMAL,fontSize:14}})),t}return _create_class(l,[{key:"render",value:function(){var{addon:t,manager:n,shouldRestart:l}=this.props;return React$1.createElement(ReactNative$1.View,{style:{...this.styles.card,...t.failed?this.styles.failed:{}}},React$1.createElement(ReactNative$1.View,{style:this.styles.header},this.renderMetadata(),this.renderAuthors(),React$1.createElement(ReactNative$1.Switch,{onChange:()=>{n.toggle(t.id),l&&Dialog.confirm({title:i18n$1.Messages.ENMITY_CHANGE_RESTART,body:i18n$1.Messages.ENMITY_CHANGE_RESTART_DESC,confirmText:i18n$1.Messages.ENMITY_RESTART,onConfirm:_async_to_generator$2(function*(){return yield reload()})})},disabled:t.failed,value:n.isEnabled(t.id)})),React$1.createElement(ReactNative$1.View,{style:this.styles.info},this.renderBody()))}},{key:"renderMetadata",value:function(){var{addon:t}=this.props;return React$1.createElement(React$1.Fragment,null,React$1.createElement(ReactNative$1.Text,{style:this.styles.name},t.data.name),React$1.createElement(ReactNative$1.Text,{style:this.styles.version},t.data.version??"?.?.?"))}},{key:"renderAuthors",value:function(){var{addon:t}=this.props;return React$1.createElement(React$1.Fragment,null,React$1.createElement(ReactNative$1.Text,{style:this.styles.by},"by"),React$1.createElement(ReactNative$1.FlatList,{data:t.data.authors??[{name:"???"}],horizontal:!0,style:{flex:1},keyExtractor:(t,n)=>String(n),renderItem:({item:n,index:l})=>{var u=l!==(t.data.authors??[{name:"???"}]).length-1&&React$1.createElement(ReactNative$1.Text,{style:this.styles.authors},", ");return n.name&&n.id?React$1.createElement(ReactNative$1.TouchableOpacity,{style:this.styles.authorContainer,onPress:this.onTapAuthor.bind(this,n)},React$1.createElement(ReactNative$1.Text,{style:{...this.styles.authors,...this.styles.touchable}},n.name),u):React$1.createElement(ReactNative$1.View,{style:this.styles.authorContainer},React$1.createElement(ReactNative$1.Text,{style:this.styles.authors},n.name??n),u)}}))}},{key:"renderBody",value:function(){var{addon:t,manager:n}=this.props,l=n.errors.get(t.id??t.data.path);return React$1.createElement(React$1.Fragment,null,React$1.createElement(ReactNative$1.Text,{style:this.styles.description},t.data.description??i18n$1.Messages.ENMITY_ADDON_NO_DESCRIPTION),t.failed&&React$1.createElement(ReactNative$1.Text,{style:{...this.styles.description,...this.styles.error}},i18n$1.Messages.ENMITY_ADDON_FAILED.format({error:l.message})))}},{key:"onTapAuthor",value:function(t){return _async_to_generator$2(function*(){Users.getUser(t.id)||(yield AsyncUsers.fetchProfile(t.id)),Profiles.showUserProfile({userId:t.id})})()}}]),l}(React$1.Component),managers=Object.freeze({__proto__:null,plugins:Plugins$2,themes:Themes$3}),utilities=Object.freeze({__proto__:null,attempt:attempt,capitalize:capitalize,colorize:colorize,debounce:debounce,findInReactTree:findInReactTree,findInTree:findInTree,forceRender:forceRender,isEmpty:isEmpty,noop:noop,uuid:uuid}),Patcher$1=createPatcher("enmity-commands"),Logger$2=createLogger("Commands"),[Commands$1,Assets,SearchStore]=bulk({filter:Filters.byProps("getBuiltInCommands")},{filter:Filters.byProps("getApplicationIconURL")},{filter:t=>t.default?.getQueryCommands&&t.useDiscoveryState}),data={commands:[],section:{id:"enmity",type:1,name:"Enmity",icon:"https://files.enmity.app/icon.png"}};try{initialize$1()}catch(e){Logger$2.error("Failed to patch commands:",e.message)}function registerCommands(t,n){if(t&&"string"==typeof t){if(!n||!Array.isArray(n))throw TypeError("second argument cmds must be of type array")}else throw TypeError("first argument caller must be of type string");for(var l in n){var u=n[l];n[l]={displayName:u.name,displayDescription:u.description,type:2,inputType:1,id:`enmity-${u.name.replaceAll(" ","-")}`,applicationId:data.section.id,...u,__ENMITY__:!0,caller:t}}data.commands.push(...n)}function unregisterCommands(t){if(!t||"string"!=typeof t)throw TypeError("first argument caller must be of type string");commands=commands.filter(n=>n.caller!==t)}function initialize$1(){Commands$1.BUILT_IN_SECTIONS.enmity=data.section;try{Patcher$1.after(SearchStore.default,"getQueryCommands",(t,[,,n],l)=>{var u=function(t){if(!~t.name?.indexOf(n)||l.some(n=>n.__enmity&&n.id===t.id))return"continue";try{l.unshift(t)}catch{l=[...l,t]}};if(!(!n||n.startsWith("/")))for(var f of(l??=[],data.commands))u(f)})}catch{Logger$2.error("Patching getQueryCommands failed.")}try{Patcher$1.instead(SearchStore.default,"getApplicationdata.sections",(t,n,l)=>{try{var u=l.apply(self,n)??[];return!u.find(t=>t.id===data.section.id)&&data.commands.length&&u.push(data.section),u}catch{return[]}})}catch{Logger$2.error("Patching getApplicationdata.sections failed.")}try{Patcher$1.after(SearchStore,"useDiscoveryState",(t,[,n],l)=>{if(1===n){if(l.data.sectionDescriptors?.find?.(t=>t.id===data.section.id)||(l.data.sectionDescriptors??=[],l.data.sectionDescriptors.push(data.section)),l.filtereddata.sectionId&&l.filtereddata.sectionId!==data.section.id||l.activedata.sections.find(t=>t.id===data.section.id)||l.activedata.sections.push(data.section),data.commands.some(t=>!l.commands?.find?.(n=>n.id===t.id))){l.commands??=[];var u=[...l.commands,...data.commands];l.commands=[...new Set(u).values()]}l.filtereddata.sectionId&&l.filtereddata.sectionId!==data.section.id||l.commandsByActivedata.section.find(t=>t.data.section.id===data.section.id)||l.commandsByActivedata.section.push({section:data.section,data:data.commands});var f=l.commandsByActivedata.section.find(t=>t.data.section.id===data.section.id);(!l.filtereddata.sectionId||l.filtereddata.sectionId===data.section.id)&&f&&0===f.data.length&&0!==data.commands.length&&(f.data=data.commands);var d=l.data.sectionDescriptors.filter(t=>"-1"===t.id);d.length>1&&(l.data.sectionDescriptors=l.data.sectionDescriptors.filter(t=>"-1"!==t.id),l.data.sectionDescriptors.push(d.find(t=>"-1"===t.id)))}})}catch{Logger$2.error("Patching useDiscoveryState failed.")}try{Patcher$1.after(Assets,"getApplicationIconURL",(t,[n],l)=>{if("enmity"===n.id)return data.section.icon})}catch{Logger$2.error("Patching getApplicationIconURL failed.")}}var commands$1=Object.freeze({__proto__:null,data:data,registerCommands:registerCommands,unregisterCommands:unregisterCommands}),toasts=Object.freeze({__proto__:null}),ENMITY_GENERAL="General",ENMITY_PLUGINS="Plugins",ENMITY_THEMES="Themes",ENMITY_UPDATER="Updater",ENMITY_DEBUG_LOGS="Debug Logs",ENMITY_SEARCH_PLUGINS="Search plugins...",ENMITY_SEARCH_THEMES="Search themes...",ENMITY_SEARCH_ASSETS="Search assets...",ENMITY_DEVELOPMENT_SETTINGS="Development Settings",ENMITY_DEBUG_BRIDGE_IP="Debug IP",ENMITY_DEBUG_BRIDGE_CONNECT="Connect to the debug bridge on startup",ENMITY_DEBUG_BRIDGE="Debug Bridge",ENMITY_TOAST_SETTINGS="Toast Settings",ENMITY_ASSET_BROWSER="Asset Browser",ENMITY_ADDON_NO_DESCRIPTION="No description provided.",ENMITY_ADDON_FAILED="This addon failed to load: {error}",ENMITY_INSTALL="Install",ENMITY_INSTALL_TITLE="Install {type}",ENMITY_THEME_EDITOR="Theme Editor",ENMITY_THEME_GET_DESC="Would you like to create or import a theme?",ENMITY_THEME_GET_OPTION_CREATE="Create",ENMITY_THEME_GET_OPTION_IMPORT="Import",ENMITY_RESTART="Restart",ENMITY_CHANGE_RESTART="Restart Required",ENMITY_CHANGE_RESTART_DESC="A restart is required to apply this change, would you like to restart?",enUS={ENMITY_GENERAL:ENMITY_GENERAL,ENMITY_PLUGINS:ENMITY_PLUGINS,ENMITY_THEMES:ENMITY_THEMES,ENMITY_UPDATER:ENMITY_UPDATER,ENMITY_DEBUG_LOGS:ENMITY_DEBUG_LOGS,ENMITY_SEARCH_PLUGINS:ENMITY_SEARCH_PLUGINS,ENMITY_SEARCH_THEMES:ENMITY_SEARCH_THEMES,ENMITY_SEARCH_ASSETS:ENMITY_SEARCH_ASSETS,ENMITY_DEVELOPMENT_SETTINGS:ENMITY_DEVELOPMENT_SETTINGS,ENMITY_DEBUG_BRIDGE_IP:ENMITY_DEBUG_BRIDGE_IP,ENMITY_DEBUG_BRIDGE_CONNECT:ENMITY_DEBUG_BRIDGE_CONNECT,ENMITY_DEBUG_BRIDGE:ENMITY_DEBUG_BRIDGE,ENMITY_TOAST_SETTINGS:ENMITY_TOAST_SETTINGS,ENMITY_ASSET_BROWSER:ENMITY_ASSET_BROWSER,ENMITY_ADDON_NO_DESCRIPTION:ENMITY_ADDON_NO_DESCRIPTION,ENMITY_ADDON_FAILED:ENMITY_ADDON_FAILED,ENMITY_INSTALL:ENMITY_INSTALL,ENMITY_INSTALL_TITLE:ENMITY_INSTALL_TITLE,ENMITY_THEME_EDITOR:ENMITY_THEME_EDITOR,ENMITY_THEME_GET_DESC:ENMITY_THEME_GET_DESC,ENMITY_THEME_GET_OPTION_CREATE:ENMITY_THEME_GET_OPTION_CREATE,ENMITY_THEME_GET_OPTION_IMPORT:ENMITY_THEME_GET_OPTION_IMPORT,ENMITY_RESTART:ENMITY_RESTART,ENMITY_CHANGE_RESTART:ENMITY_CHANGE_RESTART,ENMITY_CHANGE_RESTART_DESC:ENMITY_CHANGE_RESTART_DESC},enGB={},Strings={"en-US":enUS,"en-GB":enGB};function asyncGeneratorStep$1(t,n,l,u,f,d,h){try{var g=t[d](h),y=g.value}catch(t){l(t);return}g.done?n(y):Promise.resolve(y).then(u,f)}function _async_to_generator$1(t){return function(){var n=this,l=arguments;return new Promise(function(u,f){var d=t.apply(n,l);function h(t){asyncGeneratorStep$1(d,u,f,h,g,"next",t)}function g(t){asyncGeneratorStep$1(d,u,f,h,g,"throw",t)}h(void 0)})}}var state={locale:"en-US",messages:{}};function add(t){if("object"!=typeof t||Array.isArray(t))throw Error("Locale strings must be an object with languages and strings.");for(var n in t)addStrings(n,t[n]);return{remove:()=>{var n=i18n$1._provider._context;for(var l in t)for(var u of Object.keys(t[l]))delete n.defaultMessages[u],delete n.messages[u],delete i18n$1.Messages[u]}}}function addStrings(t,n){state.locale&&(state.messages[t]??={},Object.assign(state.messages[t],n),i18n$1.loadPromise.then(inject))}function inject(){if(state.locale&&i18n$1?.getLocale){var t=i18n$1._provider._context;Object.assign(t.messages,state.messages[state.locale]??{}),Object.assign(t.defaultMessages,state.messages["en-US"]??{})}}function onChange(t){return _onChange.apply(this,arguments)}function _onChange(){return(_onChange=_async_to_generator$1(function*(t){state.locale=t,yield i18n$1.loadPromise,inject()})).apply(this,arguments)}i18n$1?.getLocale&&(state.locale=i18n$1.getLocale()??"en-US",i18n$1.on("locale",onChange),add(Strings));var i18n=Object.freeze({__proto__:null,add:add,state:state}),metro=Object.assign(Modules,{components:Components,filters:Filters,actions:Actions,common:Common,stores:Stores,api:API$1,ui:UI}),API=Object.freeze({__proto__:null,assets:assets$1,commands:commands$1,components:components,i18n:i18n,managers:managers,metro:metro,native:native,patcher:patcher,storage:storage,toasts:toasts,utilities:utilities});function Addons({addons:t,type:n,shouldRestart:l}){var[u,f]=React$1.useState(""),d=u?[]:t;if(u)for(var h of t)(h.data.name.toLowerCase().includes(u)||h.data.description.toLowerCase().includes(u)||h.data.authors.some(t=>t.name.includes(u)))&&d.push(h);return React$1.createElement(ReactNative$1.SafeAreaView,{style:{flex:1}},React$1.createElement(ReactNative$1.View,{style:{flex:1}},React$1.createElement(Search,{placeholder:i18n$1.Messages[`ENMITY_SEARCH_${n.toUpperCase()}`],onChangeText:t=>f(t),onClear:()=>f(""),value:u}),React$1.createElement(ReactNative$1.FlatList,{data:d,renderItem:t=>React$1.createElement(_class,{shouldRestart:l,manager:managers[n],addon:t.item}),keyExtractor:(t,n)=>String(n)})))}var Plugins=()=>{var t=Navigation.useNavigation(),n=Plugins$2.useEntities();return React$1.useEffect(()=>{t.setOptions({headerRight:()=>React$1.createElement(HeaderRight,null)})},[]),React$1.createElement(ReactNative$1.View,{style:{flex:1}},React$1.createElement(Addons,{type:"plugins",addons:n}))};function HeaderRight(){var t=React$1.useRef(),n=React$1.useCallback(()=>t.current?.getInput(),[t.current]);return React$1.createElement(ReactNative$1.TouchableOpacity,{style:{marginRight:20},onPress:()=>{Dialog.confirm({title:i18n$1.Messages.ENMITY_INSTALL_TITLE.format({type:"plugin"}),children:React$1.createElement(InstallModal,{manager:Plugins$2,ref:t}),confirmText:i18n$1.Messages.ENMITY_INSTALL,onConfirm:()=>n()&&Plugins$2.install(n())})}},React$1.createElement(ReactNative$1.Image,{source:Icons.ic_add_circle}))}var Themes=()=>{var t=Navigation.useNavigation(),n=Themes$3.useEntities();return React$1.useEffect(()=>{t.setOptions({headerRight:()=>React$1.createElement(Add,null)})},[]),React$1.createElement(ErrorBoundary,null,React$1.createElement(ReactNative$1.View,{style:{flex:1}},React$1.createElement(Addons,{shouldRestart:!0,type:"themes",addons:n})))};function Add(){var t=Navigation.useNavigation(),n=React$1.useRef();return React$1.createElement(ReactNative$1.TouchableOpacity,{style:{marginRight:20},onPress:()=>{Dialog.confirm({title:i18n$1.Messages.ENMITY_INSTALL_TITLE.format({type:"theme"}),confirmText:i18n$1.Messages.ENMITY_THEME_GET_OPTION_CREATE,cancelText:i18n$1.Messages.ENMITY_THEME_GET_OPTION_IMPORT,body:i18n$1.Messages.ENMITY_THEME_GET_DESC,onConfirm:()=>{t.push(Screens.Custom,{title:i18n$1.Messages.ENMITY_THEME_EDITOR,render:()=>React$1.createElement(ReactNative$1.Text,null,"hi")})},onCancel:()=>{Dialog.confirm({title:i18n$1.Messages.ENMITY_INSTALL_TITLE.format({type:"plugin"}),children:React$1.createElement(InstallModal,{manager:Themes$3,ref:n}),confirmText:i18n$1.Messages.ENMITY_INSTALL,onConfirm:()=>{alert(n?.current?.getInput())}})}})}},React$1.createElement(ReactNative$1.Image,{source:Icons.ic_add_circle}))}var Patcher=createPatcher("settings");function apply$2(){var[t,n]=findByName({params:["UserSettingsOverviewWrapper"],interop:!1},{params:["getScreens"],interop:!1},{bulk:!0}),l=Patcher.after(t,"default",(t,n,u)=>{var f=findInReactTree(u,t=>t.type?.name==="UserSettingsOverview");if(!f)return u;patchSettings(f),l()});Patcher.after(n,"default",(t,n,l)=>({...l,[Screens.General]:{key:Screens.General,title:"Enmity",render:General},[Screens.Plugins]:{key:Screens.Plugins,render:Plugins,get title(){return i18n$1.Messages.ENMITY_PLUGINS}},[Screens.Themes]:{key:Screens.Themes,render:Themes,get title(){return i18n$1.Messages.ENMITY_THEMES}},[Screens.Updater]:{key:Screens.Updater,render:()=>null,get title(){return i18n$1.Messages.ENMITY_UPDATER}},[Screens.Custom]:{key:Screens.Custom,title:"Page",render:({title:t,render:n,...l})=>{var u=Navigation.useNavigation();return React$1.useEffect(()=>{t&&u.setOptions({title:t})},[]),React$1.createElement(n,l)}}}))}function patchSettings(t){Patcher.after(t.type.prototype,"render",(t,n,l)=>{var{navigation:u}=t.props,{children:f}=l.props,d=f.findIndex(t=>t?.props?.title===i18n$1.Messages.PREMIUM_SETTINGS_GENERIC);f.splice(d,0,React$1.createElement(React$1.Fragment,null,React$1.createElement(Forms.FormSection,{key:"Enmity",title:"Enmity"},React$1.createElement(Forms.FormRow,{label:i18n$1.Messages.ENMITY_GENERAL,leading:React$1.createElement(Forms.FormRow.Icon,{source:{uri:"https://files.enmity.app/icon-64.png"}}),trailing:React$1.createElement(Forms.FormArrow,null),onPress:()=>u.push(Screens.General,{...t.props,...l.props})}),React$1.createElement(Forms.FormDivider,null),React$1.createElement(Forms.FormRow,{label:i18n$1.Messages.ENMITY_PLUGINS,leading:React$1.createElement(puzzle,{height:24,width:24}),trailing:React$1.createElement(Forms.FormArrow,null),onPress:()=>u.push(Screens.Plugins,{...t.props,...l.props})}),React$1.createElement(Forms.FormDivider,null),React$1.createElement(Forms.FormRow,{label:i18n$1.Messages.ENMITY_THEMES,leading:React$1.createElement(palette,{height:24,width:24}),trailing:React$1.createElement(Forms.FormArrow,null),onPress:()=>u.push(Screens.Themes,{...t.props,...l.props})}),React$1.createElement(Forms.FormDivider,null),React$1.createElement(Forms.FormRow,{label:i18n$1.Messages.ENMITY_UPDATER,leading:React$1.createElement(Forms.FormRow.Icon,{source:Icons.ic_download_24px}),trailing:React$1.createElement(Forms.FormArrow,null),onPress:()=>u.push(Screens.Updater,{...t.props,...l.props})}))));var h=f.find(t=>t?.props.title===i18n$1.Messages.SUPPORT),g=h?.props.children;g&&(h.props.children=g.filter(t=>t?.type?.name!=="UploadLogsButton"))})}function remove$2(){Patcher.unpatchAll()}var settings=Object.freeze({__proto__:null,apply:apply$2,remove:remove$2});!function(t){t[t.error=3]="error",t[t.info=1]="info",t[t.log=1]="log",t[t.warn=2]="warn",t[t.trace=0]="trace",t[t.debug=0]="debug"}(Levels||(Levels={}));var methods=["error","info","log","warn","trace","debug"];function apply$1(){var t=function(t){console[t].__ORIGINAL__=console[t],console[t]=(...l)=>{for(var u=[],f=0,d=l.length;d>f;f++)u.push("string"==typeof l[f]?l[f]:n.inspect?.(l[f])??l[f].toString());var h=u.join(" ");addLog({message:h,level:Levels[t]}),nativeLoggingHook(h,Levels[t]??Levels.info)}},n=findByProps("inspect",{lazy:!0});for(var l of methods)t(l)}function remove$1(){for(var t of methods){var n=console[t].__ORIGINAL__;n&&(console[t]=n)}}var console$1=Object.freeze({__proto__:null,get Levels(){return Levels},apply:apply$1,remove:remove$1}),Patches$1=Object.freeze({__proto__:null,Console:console$1,Settings:settings,ThemeFix:themeFix}),Logger$1=createLogger("Core","Patches");function apply(){for(var t in Patches$1){var n=Patches$1[t];try{n.apply?.()}catch(n){Logger$1.error(`Failed to apply ${t} patch:`,n.message)}}}function remove(){for(var t in Patches$1){var n=Patches$1[t];try{n.remove?.()}catch(n){Logger$1.error(`Failed to remove ${t} patch:`,n.message)}}}var Patches={apply,remove},debug=[{name:"debug",description:"Prints out information to help debug enmity.",execute:()=>{}}],Commands=Object.freeze({__proto__:null,debug:debug});function asyncGeneratorStep(t,n,l,u,f,d,h){try{var g=t[d](h),y=g.value}catch(t){l(t);return}g.done?n(y):Promise.resolve(y).then(u,f)}function _async_to_generator(t){return function(){var n=this,l=arguments;return new Promise(function(u,f){var d=t.apply(n,l);function h(t){asyncGeneratorStep(d,u,f,h,g,"next",t)}function g(t){asyncGeneratorStep(d,u,f,h,g,"throw",t)}h(void 0)})}}var Logger=createLogger("Core");function initialize(){return _initialize.apply(this,arguments)}function _initialize(){return(_initialize=_async_to_generator(function*(){try{Patches.apply()}catch(t){Logger.error("Failed to apply patches:",t.message)}try{BuiltIns.initialize()}catch(t){Logger.error("Failed to apply built-ins:",t.message)}try{var{commands:t}=API;t.registerCommands("enmity",Commands)}catch(t){Logger.error("Failed to register built-in commands:",t.message)}return window.enmity=API,API})).apply(this,arguments)}function shutdown(){return _shutdown.apply(this,arguments)}function _shutdown(){return(_shutdown=_async_to_generator(function*(){var{patcher:t}=API;for(var n in t.unpatchAll(),managers){var l=managers[n];yield l.shutdown()}Patches.remove(),BuiltIns.shutdown(),delete window.enmity})).apply(this,arguments)}var index={initialize,shutdown},index$1=Object.freeze({__proto__:null,default:index,initialize:initialize,shutdown:shutdown});
